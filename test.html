<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ çµ±åˆãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ« - éšœå®³å¹´é‡‘ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .log-entry {
            margin: 4px 0;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            word-break: break-all;
        }
        .log-success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .log-error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .log-info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .log-warning { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
        .log-debug { background-color: #e2e3e5; color: #383d41; border: 1px solid #d6d8db; }
        
        .json-viewer {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 12px;
            margin-top: 8px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .status-connected { background-color: #28a745; }
        .status-disconnected { background-color: #dc3545; }
        .status-checking { background-color: #ffc107; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .tab-button {
            transition: all 0.2s ease;
        }
        
        .tab-button.active {
            background-color: #3b82f6;
            color: white;
            border-bottom: 2px solid #1d4ed8;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ”§ çµ±åˆãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
            <p class="text-gray-600">APIæ¥ç¶šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãã—ã¦project-unified.htmlã®å•é¡Œã‚’åŒ…æ‹¬çš„ã«è¨ºæ–­ã—ã¾ã™</p>
        </div>

        <!-- å¼·åŒ–ã•ã‚ŒãŸæ¥ç¶šçŠ¶æ…‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold flex items-center">
                    <span id="connectionStatus" class="status-indicator status-checking"></span>
                    æ¥ç¶šçŠ¶æ…‹ç›£è¦–
                </h2>
                <div class="flex space-x-2">
                    <button onclick="toggleConnectionMonitor()" id="monitorToggle"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded text-sm transition-colors">
                        ç›£è¦–é–‹å§‹
                    </button>
                    <button onclick="runConnectionDiagnostics()"
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded text-sm transition-colors">
                        è©³ç´°è¨ºæ–­
                    </button>
                    <button onclick="runSpeedTest()"
                            class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-1 px-3 rounded text-sm transition-colors">
                        é€Ÿåº¦ãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
            </div>
            
            <!-- æ¥ç¶šå“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹ -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="bg-gray-50 p-3 rounded text-center">
                    <h4 class="text-xs font-medium text-gray-600 mb-1">ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</h4>
                    <p id="latencyMetric" class="text-lg font-bold text-blue-600">-</p>
                    <p class="text-xs text-gray-500">ms</p>
                </div>
                <div class="bg-gray-50 p-3 rounded text-center">
                    <h4 class="text-xs font-medium text-gray-600 mb-1">å®‰å®šæ€§</h4>
                    <p id="stabilityMetric" class="text-lg font-bold text-green-600">-</p>
                    <p class="text-xs text-gray-500">%</p>
                </div>
                <div class="bg-gray-50 p-3 rounded text-center">
                    <h4 class="text-xs font-medium text-gray-600 mb-1">æˆåŠŸç‡</h4>
                    <p id="successRateMetric" class="text-lg font-bold text-purple-600">-</p>
                    <p class="text-xs text-gray-500">%</p>
                </div>
                <div class="bg-gray-50 p-3 rounded text-center">
                    <h4 class="text-xs font-medium text-gray-600 mb-1">å“è³ª</h4>
                    <p id="qualityMetric" class="text-lg font-bold text-orange-600">-</p>
                    <p class="text-xs text-gray-500">è©•ä¾¡</p>
                </div>
            </div>
            
            <!-- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ¥çŠ¶æ…‹ -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-gray-50 p-4 rounded">
                    <h3 class="font-medium text-gray-700 mb-2 flex items-center">
                        <span id="apiStatusIndicator" class="status-indicator status-checking mr-2"></span>
                        APIã‚µãƒ¼ãƒãƒ¼
                    </h3>
                    <p id="apiStatus" class="text-sm text-gray-600">ç¢ºèªä¸­...</p>
                    <p id="apiResponseTime" class="text-xs text-gray-500 mt-1">-</p>
                </div>
                <div class="bg-gray-50 p-4 rounded">
                    <h3 class="font-medium text-gray-700 mb-2 flex items-center">
                        <span id="dbStatusIndicator" class="status-indicator status-checking mr-2"></span>
                        ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
                    </h3>
                    <p id="dbStatus" class="text-sm text-gray-600">ç¢ºèªä¸­...</p>
                    <p id="dbResponseTime" class="text-xs text-gray-500 mt-1">-</p>
                </div>
                <div class="bg-gray-50 p-4 rounded">
                    <h3 class="font-medium text-gray-700 mb-2 flex items-center">
                        <span id="authStatusIndicator" class="status-indicator status-checking mr-2"></span>
                        èªè¨¼çŠ¶æ…‹
                    </h3>
                    <p id="authStatus" class="text-sm text-gray-600">ç¢ºèªä¸­...</p>
                    <p id="authResponseTime" class="text-xs text-gray-500 mt-1">-</p>
                </div>
                <div class="bg-gray-50 p-4 rounded">
                    <h3 class="font-medium text-gray-700 mb-2 flex items-center">
                        <span id="unifiedStatusIndicator" class="status-indicator status-checking mr-2"></span>
                        project-unified
                    </h3>
                    <p id="unifiedStatus" class="text-sm text-gray-600">ç¢ºèªä¸­...</p>
                    <p id="unifiedResponseTime" class="text-xs text-gray-500 mt-1">-</p>
                </div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="bg-white rounded-lg shadow mb-6">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8 px-6">
                    <button onclick="switchTab('api-test')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 active">
                        ğŸš€ API ãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="switchTab('project-debug')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ› project-unified è¨ºæ–­
                    </button>
                    <button onclick="switchTab('console-monitor')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ“Š ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–
                    </button>
                    <button onclick="switchTab('network-monitor')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–
                    </button>
                    <button onclick="switchTab('auto-diagnosis')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ¤– è‡ªå‹•è¨ºæ–­
                    </button>
                    <button onclick="switchTab('performance-monitor')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
                    </button>
                    <button onclick="switchTab('connection-monitor')" class="tab-button py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        ğŸ”— æ¥ç¶šç›£è¦–
                    </button>
                </nav>
            </div>
        </div>
        
        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: API ãƒ†ã‚¹ãƒˆ -->
        <div id="api-test" class="tab-content active">
            <!-- APIè¨­å®š -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ”§ APIè¨­å®š</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ™ãƒ¼ã‚¹URL</label>
                        <input type="text" id="baseUrl" value="https://nennkinn-claud.vercel.app/api" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³</label>
                        <input type="text" id="authToken" placeholder="Bearer tokenï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">âš¡ ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <button onclick="testHealthCheck()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
                    </button>
                    <button onclick="testLogin()" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="testApplications()" 
                            class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ç”³è«‹ãƒ‡ãƒ¼ã‚¿å–å¾—
                    </button>
                    <button onclick="testDatabaseConnection()" 
                            class="bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        DBæ¥ç¶šãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
            </div>

            <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ› ï¸ ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ¡ã‚½ãƒƒãƒ‰</label>
                        <select id="method" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</label>
                        <input type="text" id="endpoint" placeholder="/applications" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ï¼ˆJSONï¼‰</label>
                    <textarea id="requestBody" rows="4" placeholder='{"key": "value"}'
                              class="w-full px-3 py-2 border border-gray-300 rounded-md font-mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <button onclick="sendCustomRequest()" 
                        class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded transition-colors">
                    ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
                </button>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: project-unified è¨ºæ–­ -->
        <div id="project-debug" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ› project-unified.html è¨ºæ–­</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <button onclick="testUnifiedPageLoad()" 
                            class="bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="testApplicationApiLoad()" 
                            class="bg-teal-500 hover:bg-teal-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        application-api.js ãƒã‚§ãƒƒã‚¯
                    </button>
                    <button onclick="simulateEditMode()" 
                            class="bg-pink-500 hover:bg-pink-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ç·¨é›†ãƒ¢ãƒ¼ãƒ‰(?edit=1) æ¨¡æ“¬
                    </button>
                    <button onclick="testLocalStorageData()" 
                            class="bg-cyan-500 hover:bg-cyan-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <button onclick="testProjectUnifiedDirectly()" 
                            class="bg-violet-500 hover:bg-violet-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        project-unifiedç›´æ¥ãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="simulateFormSubmission()" 
                            class="bg-emerald-500 hover:bg-emerald-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ¨¡æ“¬
                    </button>
                    <button onclick="testDOMManipulation()" 
                            class="bg-amber-500 hover:bg-amber-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        DOMæ“ä½œãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="validateProjectUnifiedIntegrity()" 
                            class="bg-rose-500 hover:bg-rose-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        æ•´åˆæ€§æ¤œè¨¼
                    </button>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ†ã‚¹ãƒˆç”¨ç”³è«‹ID</label>
                    <input type="text" id="testApplicationId" value="1" placeholder="1" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦– -->
        <div id="console-monitor" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ“Š ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–</h2>
                <div class="mb-4">
                    <button onclick="toggleConsoleCapture()" id="consoleToggle"
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition-colors mr-2">
                        ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–é–‹å§‹
                    </button>
                    <button onclick="clearConsoleLog()" 
                            class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¯ãƒªã‚¢
                    </button>
                </div>
                <div id="consoleOutput" class="bg-gray-900 text-green-400 p-4 rounded-md font-mono text-sm max-h-96 overflow-y-auto">
                    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–å¾…æ©Ÿä¸­...
                </div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦– -->
        <div id="network-monitor" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆç›£è¦–</h2>
                <div class="mb-4">
                    <button onclick="toggleNetworkCapture()" id="networkToggle"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition-colors mr-2">
                        ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–é–‹å§‹
                    </button>
                    <button onclick="clearNetworkLog()" 
                            class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ­ã‚°ã‚¯ãƒªã‚¢
                    </button>
                </div>
                <div id="networkOutput" class="bg-gray-50 p-4 rounded-md max-h-96 overflow-y-auto">
                    <div class="text-gray-500 text-sm">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–å¾…æ©Ÿä¸­...</div>
                </div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: è‡ªå‹•è¨ºæ–­ -->
        <div id="auto-diagnosis" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ¤– è‡ªå‹•è¨ºæ–­ã‚·ãƒ¼ã‚±ãƒ³ã‚¹</h2>
                <div class="mb-4">
                    <p class="text-gray-600 mb-4">project-unified.htmlã®å•é¡Œã‚’ä½“ç³»çš„ã«è¨ºæ–­ã—ã¾ã™ã€‚</p>
                    <button onclick="runFullDiagnosis()" id="diagnosisButton"
                            class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-medium py-3 px-6 rounded-lg transition-all mr-4">
                        ğŸš€ å®Œå…¨è¨ºæ–­é–‹å§‹
                    </button>
                    <button onclick="runQuickDiagnosis()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-6 rounded-lg transition-colors">
                        âš¡ ã‚¯ã‚¤ãƒƒã‚¯è¨ºæ–­
                    </button>
                </div>
                <div class="bg-gray-50 p-4 rounded-md">
                    <h3 class="font-medium text-gray-700 mb-2">è¨ºæ–­é€²æ—</h3>
                    <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                        <div id="diagnosisProgress" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div id="diagnosisStatus" class="text-sm text-gray-600">è¨ºæ–­å¾…æ©Ÿä¸­...</div>
                </div>
                <div id="diagnosisResults" class="mt-4 space-y-2"></div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦– -->
        <div id="performance-monitor" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <button onclick="measurePageLoadTime()" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿é€Ÿåº¦
                    </button>
                    <button onclick="measureAPIResponseTime()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        APIå¿œç­”æ™‚é–“
                    </button>
                    <button onclick="analyzeMemoryUsage()" 
                            class="bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded transition-colors">
                        ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-gray-50 p-4 rounded">
                        <h3 class="font-medium text-gray-700 mb-2">èª­ã¿è¾¼ã¿æ™‚é–“</h3>
                        <p id="loadTimeMetric" class="text-2xl font-bold text-blue-600">-</p>
                        <p class="text-sm text-gray-500">ãƒŸãƒªç§’</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <h3 class="font-medium text-gray-700 mb-2">APIå¹³å‡å¿œç­”</h3>
                        <p id="apiResponseMetric" class="text-2xl font-bold text-green-600">-</p>
                        <p class="text-sm text-gray-500">ãƒŸãƒªç§’</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <h3 class="font-medium text-gray-700 mb-2">ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</h3>
                        <p id="memoryUsageMetric" class="text-2xl font-bold text-orange-600">-</p>
                        <p class="text-sm text-gray-500">MB</p>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-md">
                    <h3 class="font-medium text-gray-700 mb-2">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ­ã‚°</h3>
                    <div id="performanceLog" class="max-h-48 overflow-y-auto text-sm text-gray-600">
                        ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šå¾…æ©Ÿä¸­...
                    </div>
                </div>
            </div>
        </div>

        <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: æ¥ç¶šç›£è¦– -->
        <div id="connection-monitor" class="tab-content">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">ğŸ”— é«˜åº¦ãªæ¥ç¶šç›£è¦–ãƒ»è¨ºæ–­</h2>
                
                <!-- ç›£è¦–åˆ¶å¾¡ -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <button onclick="startContinuousMonitoring()" id="continuousMonitorBtn"
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded transition-colors">
                        ğŸ“¡ é€£ç¶šç›£è¦–é–‹å§‹
                    </button>
                    <button onclick="runFailoverTest()" 
                            class="bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 px-4 rounded transition-colors">
                        ğŸ”„ éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆ
                    </button>
                    <button onclick="runLoadTest()" 
                            class="bg-red-500 hover:bg-red-600 text-white font-medium py-3 px-4 rounded transition-colors">
                        ğŸš€ è² è·ãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
                
                <!-- æ¥ç¶šå±¥æ­´ã‚°ãƒ©ãƒ• -->
                <div class="mb-6">
                    <h3 class="font-medium text-gray-700 mb-3">æ¥ç¶šå±¥æ­´ (ç›´è¿‘100å›)</h3>
                    <div class="bg-gray-50 p-4 rounded-md">
                        <div id="connectionChart" class="flex items-end space-x-1 h-32 overflow-hidden">
                            <div class="text-gray-500 text-sm w-full text-center py-12">ç›£è¦–ãƒ‡ãƒ¼ã‚¿å¾…æ©Ÿä¸­...</div>
                        </div>
                    </div>
                </div>
                
                <!-- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè©³ç´°çŠ¶æ…‹ -->
                <div class="mb-6">
                    <h3 class="font-medium text-gray-700 mb-3">ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè©³ç´°çŠ¶æ…‹</h3>
                    <div id="endpointDetails" class="space-y-3">
                        <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
                    </div>
                </div>
                
                <!-- æ¥ç¶šå•é¡Œãƒ¬ãƒãƒ¼ãƒˆ -->
                <div class="mb-6">
                    <h3 class="font-medium text-gray-700 mb-3">æ¥ç¶šå•é¡Œãƒ¬ãƒãƒ¼ãƒˆ</h3>
                    <div id="connectionIssues" class="bg-gray-50 p-4 rounded-md">
                        <div class="text-gray-500 text-sm">å•é¡Œæ¤œå‡ºå¾…æ©Ÿä¸­...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ­ã‚°è¡¨ç¤º -->
        <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold">ğŸ“‹ çµ±åˆãƒ­ã‚°</h2>
                <div class="space-x-2">
                    <button onclick="exportLogs()" 
                            class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-1 px-3 rounded text-sm transition-colors">
                        ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                    </button>
                    <button onclick="clearLogs()" 
                            class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded text-sm transition-colors">
                        ã‚¯ãƒªã‚¢
                    </button>
                </div>
            </div>
            <div id="logContainer" class="bg-gray-50 p-4 rounded-md max-h-96 overflow-y-auto">
                <div class="log-entry log-info">çµ±åˆãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ãŒæº–å‚™å®Œäº†ã—ã¾ã—ãŸ</div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let logs = [];
        let consoleCapturing = false;
        let networkCapturing = false;
        let originalConsole = {};
        let originalFetch = null;
        
        // æ¥ç¶šç³»å¼·åŒ–å¤‰æ•°
        let connectionMonitor = {
            isActive: false,
            interval: null,
            history: [],
            lastCheck: null,
            failureCount: 0,
            successCount: 0,
            averageResponseTime: 0,
            endpoints: [
                { name: 'Health Check', url: '/health', method: 'GET', critical: true },
                { name: 'Applications API', url: '/applications?limit=1', method: 'GET', critical: true },
                { name: 'Auth API', url: '/auth/login', method: 'POST', critical: false },
                { name: 'Static Files', url: '/js/application-api.js', method: 'GET', critical: true }
            ],
            retryConfig: {
                maxRetries: 3,
                retryDelay: 1000,
                backoffMultiplier: 2
            }
        };
        
        let networkQuality = {
            latency: 0,
            jitter: 0,
            packetLoss: 0,
            bandwidth: 0,
            stability: 'unknown'
        };

        // ãƒ­ã‚°å‡ºåŠ›é–¢æ•°
        function log(message, type = 'info', data = null) {
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            const logEntry = {
                timestamp,
                message,
                type,
                data
            };
            logs.push(logEntry);
            
            const container = document.getElementById('logContainer');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            
            let content = `[${timestamp}] ${message}`;
            entry.textContent = content;
            
            if (data) {
                const dataView = document.createElement('div');
                dataView.className = 'json-viewer';
                const pre = document.createElement('pre');
                pre.textContent = JSON.stringify(data, null, 2);
                dataView.appendChild(pre);
                entry.appendChild(dataView);
            }
            
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
        }

        function clearLogs() {
            logs = [];
            document.getElementById('logContainer').innerHTML = 
                '<div class="log-entry log-info">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</div>';
        }

        function exportLogs() {
            const logText = logs.map(log => 
                `[${log.timestamp}] [${log.type.toUpperCase()}] ${log.message}${log.data ? '\n' + JSON.stringify(log.data, null, 2) : ''}`
            ).join('\n\n');
            
            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `debug-${new Date().toISOString()}.log`;
            a.click();
        }

        // æ¥ç¶šçŠ¶æ…‹ã‚’æ›´æ–°
        function updateConnectionStatus(status) {
            const indicator = document.getElementById('connectionStatus');
            indicator.className = `status-indicator status-${status}`;
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tabName) {
            // å…¨ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // å…¨ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’è¡¨ç¤º
            document.getElementById(tabName).classList.add('active');
            
            // å¯¾å¿œã™ã‚‹ãƒœã‚¿ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–
            event.target.classList.add('active');
        }

        // å¼·åŒ–ã•ã‚ŒãŸAPIå‘¼ã³å‡ºã—é–¢æ•°
        async function makeRequest(method, endpoint, body = null, options = {}) {
            const baseUrl = document.getElementById('baseUrl').value;
            const authToken = document.getElementById('authToken').value;
            
            const url = `${baseUrl}${endpoint}`;
            const requestOptions = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                ...options
            };

            if (authToken) {
                requestOptions.headers['Authorization'] = authToken.startsWith('Bearer ') ? authToken : `Bearer ${authToken}`;
            }

            if (body && method !== 'GET') {
                requestOptions.body = JSON.stringify(body);
            }

            const startTime = performance.now();
            log(`ğŸš€ ${method} ${url}`, 'info');
            
            try {
                const response = await fetch(url, requestOptions);
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                const responseText = await response.text();
                
                let responseData;
                try {
                    responseData = JSON.parse(responseText);
                } catch {
                    responseData = responseText;
                }

                // æ¥ç¶šå±¥æ­´ã«è¨˜éŒ²
                recordConnectionHistory(endpoint, response.ok, responseTime, response.status);

                if (response.ok) {
                    log(`âœ… ${response.status} - æˆåŠŸ (${responseTime}ms)`, 'success', responseData);
                    updateConnectionStatus('connected');
                } else {
                    log(`âŒ ${response.status} ${response.statusText} - å¤±æ•— (${responseTime}ms)`, 'error', responseData);
                    updateConnectionStatus('disconnected');
                }

                return { response, data: responseData, responseTime };
            } catch (error) {
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                // æ¥ç¶šå±¥æ­´ã«ã‚¨ãƒ©ãƒ¼ã‚’è¨˜éŒ²
                recordConnectionHistory(endpoint, false, responseTime, 0, error.message);
                
                log(`ğŸ’¥ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: ${error.message} (${responseTime}ms)`, 'error');
                updateConnectionStatus('disconnected');
                return { error, responseTime };
            }
        }

        // æ¥ç¶šå±¥æ­´è¨˜éŒ²é–¢æ•°
        function recordConnectionHistory(endpoint, success, responseTime, statusCode, errorMessage = null) {
            const record = {
                timestamp: new Date(),
                endpoint: endpoint,
                success: success,
                responseTime: responseTime,
                statusCode: statusCode,
                errorMessage: errorMessage
            };
            
            connectionMonitor.history.push(record);
            
            // æœ€æ–°100ä»¶ã®ã¿ä¿æŒ
            if (connectionMonitor.history.length > 100) {
                connectionMonitor.history.shift();
            }
            
            // çµ±è¨ˆæ›´æ–°
            updateConnectionStatistics();
            
            // ã‚°ãƒ©ãƒ•æ›´æ–°
            updateConnectionChart();
        }

        // æ¥ç¶šçµ±è¨ˆæ›´æ–°
        function updateConnectionStatistics() {
            const history = connectionMonitor.history;
            if (history.length === 0) return;
            
            const recentHistory = history.slice(-20); // ç›´è¿‘20å›
            const successCount = recentHistory.filter(r => r.success).length;
            const totalCount = recentHistory.length;
            const responseTimes = recentHistory.filter(r => r.success).map(r => r.responseTime);
            
            // æˆåŠŸç‡
            const successRate = Math.round((successCount / totalCount) * 100);
            document.getElementById('successRateMetric').textContent = successRate;
            
            // å¹³å‡å¿œç­”æ™‚é–“ï¼ˆãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼‰
            if (responseTimes.length > 0) {
                const avgResponseTime = Math.round(responseTimes.reduce((a, b) => a + b) / responseTimes.length);
                document.getElementById('latencyMetric').textContent = avgResponseTime;
                connectionMonitor.averageResponseTime = avgResponseTime;
            }
            
            // å®‰å®šæ€§ï¼ˆå¿œç­”æ™‚é–“ã®ã°ã‚‰ã¤ãï¼‰
            if (responseTimes.length > 1) {
                const mean = responseTimes.reduce((a, b) => a + b) / responseTimes.length;
                const variance = responseTimes.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / responseTimes.length;
                const stability = Math.max(0, 100 - Math.sqrt(variance) / 10);
                document.getElementById('stabilityMetric').textContent = Math.round(stability);
            }
            
            // å“è³ªè©•ä¾¡
            let quality = 'ä¸æ˜';
            if (successRate >= 95 && connectionMonitor.averageResponseTime < 500) {
                quality = 'å„ªç§€';
            } else if (successRate >= 90 && connectionMonitor.averageResponseTime < 1000) {
                quality = 'è‰¯å¥½';
            } else if (successRate >= 80) {
                quality = 'æ™®é€š';
            } else {
                quality = 'è¦æ”¹å–„';
            }
            document.getElementById('qualityMetric').textContent = quality;
        }

        // æ¥ç¶šãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        function updateConnectionChart() {
            const chart = document.getElementById('connectionChart');
            const history = connectionMonitor.history.slice(-50); // ç›´è¿‘50å›
            
            if (history.length === 0) return;
            
            chart.innerHTML = '';
            
            history.forEach((record, index) => {
                const bar = document.createElement('div');
                bar.className = 'flex-1 min-w-0';
                
                const height = record.success ? 
                    Math.max(5, Math.min(100, (record.responseTime / 2000) * 100)) : 5;
                
                bar.innerHTML = `
                    <div class="w-full rounded-t ${record.success ? 'bg-green-500' : 'bg-red-500'}" 
                         style="height: ${height}%" 
                         title="${record.endpoint}: ${record.success ? record.responseTime + 'ms' : 'ã‚¨ãƒ©ãƒ¼'}">
                    </div>
                `;
                
                chart.appendChild(bar);
            });
        }

        // å¼·åŒ–ã•ã‚ŒãŸæ¥ç¶šç›£è¦–æ©Ÿèƒ½
        function toggleConnectionMonitor() {
            const button = document.getElementById('monitorToggle');
            
            if (!connectionMonitor.isActive) {
                startConnectionMonitor();
                button.textContent = 'ç›£è¦–åœæ­¢';
                button.className = button.className.replace('bg-blue-500', 'bg-red-500').replace('hover:bg-blue-600', 'hover:bg-red-600');
            } else {
                stopConnectionMonitor();
                button.textContent = 'ç›£è¦–é–‹å§‹';
                button.className = button.className.replace('bg-red-500', 'bg-blue-500').replace('hover:bg-red-600', 'hover:bg-blue-600');
            }
        }

        function startConnectionMonitor() {
            connectionMonitor.isActive = true;
            connectionMonitor.interval = setInterval(checkAllEndpoints, 5000); // 5ç§’é–“éš”
            log('ğŸ“¡ æ¥ç¶šç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'info');
            checkAllEndpoints(); // å³åº§ã«å®Ÿè¡Œ
        }

        function stopConnectionMonitor() {
            connectionMonitor.isActive = false;
            if (connectionMonitor.interval) {
                clearInterval(connectionMonitor.interval);
            }
            log('ğŸ“¡ æ¥ç¶šç›£è¦–ã‚’åœæ­¢ã—ã¾ã—ãŸ', 'info');
        }

        async function checkAllEndpoints() {
            for (const endpoint of connectionMonitor.endpoints) {
                await checkEndpoint(endpoint);
                await new Promise(resolve => setTimeout(resolve, 200)); // 200msé–“éš”
            }
            updateEndpointDetails();
        }

        async function checkEndpoint(endpoint) {
            try {
                const result = await makeRequest(endpoint.method, endpoint.url, null, { timeout: 5000 });
                
                const indicatorId = getIndicatorId(endpoint.name);
                const statusId = getStatusId(endpoint.name);
                const responseTimeId = getResponseTimeId(endpoint.name);
                
                if (result.data || result.response?.ok) {
                    updateEndpointUI(indicatorId, statusId, responseTimeId, true, result.responseTime);
                    connectionMonitor.successCount++;
                } else {
                    updateEndpointUI(indicatorId, statusId, responseTimeId, false, result.responseTime);
                    connectionMonitor.failureCount++;
                    
                    if (endpoint.critical) {
                        await attemptAutoReconnect(endpoint);
                    }
                }
            } catch (error) {
                const indicatorId = getIndicatorId(endpoint.name);
                const statusId = getStatusId(endpoint.name);
                const responseTimeId = getResponseTimeId(endpoint.name);
                
                updateEndpointUI(indicatorId, statusId, responseTimeId, false, 0, error.message);
                connectionMonitor.failureCount++;
            }
        }

        function getIndicatorId(endpointName) {
            const mapping = {
                'Health Check': 'apiStatusIndicator',
                'Applications API': 'dbStatusIndicator',
                'Auth API': 'authStatusIndicator',
                'Static Files': 'unifiedStatusIndicator'
            };
            return mapping[endpointName] || 'apiStatusIndicator';
        }

        function getStatusId(endpointName) {
            const mapping = {
                'Health Check': 'apiStatus',
                'Applications API': 'dbStatus',
                'Auth API': 'authStatus',
                'Static Files': 'unifiedStatus'
            };
            return mapping[endpointName] || 'apiStatus';
        }

        function getResponseTimeId(endpointName) {
            const mapping = {
                'Health Check': 'apiResponseTime',
                'Applications API': 'dbResponseTime',
                'Auth API': 'authResponseTime',
                'Static Files': 'unifiedResponseTime'
            };
            return mapping[endpointName] || 'apiResponseTime';
        }

        function updateEndpointUI(indicatorId, statusId, responseTimeId, success, responseTime, errorMessage = null) {
            const indicator = document.getElementById(indicatorId);
            const status = document.getElementById(statusId);
            const responseTimeElement = document.getElementById(responseTimeId);
            
            if (success) {
                indicator.className = 'status-indicator status-connected mr-2';
                status.textContent = 'æ­£å¸¸å‹•ä½œä¸­';
                responseTimeElement.textContent = `å¿œç­”: ${responseTime}ms`;
            } else {
                indicator.className = 'status-indicator status-disconnected mr-2';
                status.textContent = errorMessage || 'æ¥ç¶šå¤±æ•—';
                responseTimeElement.textContent = `ã‚¨ãƒ©ãƒ¼`;
            }
        }

        async function attemptAutoReconnect(endpoint) {
            log(`ğŸ”„ ${endpoint.name} ã®è‡ªå‹•å¾©æ—§ã‚’è©¦è¡Œä¸­...`, 'warning');
            
            const config = connectionMonitor.retryConfig;
            let delay = config.retryDelay;
            
            for (let attempt = 1; attempt <= config.maxRetries; attempt++) {
                await new Promise(resolve => setTimeout(resolve, delay));
                
                try {
                    const result = await makeRequest(endpoint.method, endpoint.url);
                    if (result.data || result.response?.ok) {
                        log(`âœ… ${endpoint.name} ã®è‡ªå‹•å¾©æ—§ã«æˆåŠŸ (è©¦è¡Œ${attempt}å›ç›®)`, 'success');
                        return true;
                    }
                } catch (error) {
                    log(`âŒ ${endpoint.name} ã®å¾©æ—§è©¦è¡Œ${attempt}å›ç›®å¤±æ•—: ${error.message}`, 'error');
                }
                
                delay *= config.backoffMultiplier;
            }
            
            log(`ğŸ’¥ ${endpoint.name} ã®è‡ªå‹•å¾©æ—§ã«å¤±æ•—ã—ã¾ã—ãŸ`, 'error');
            return false;
        }

        async function runConnectionDiagnostics() {
            log('ğŸ” è©³ç´°æ¥ç¶šè¨ºæ–­ã‚’é–‹å§‹ã—ã¾ã™', 'info');
            
            const diagnostics = {
                dns: await testDNSResolution(),
                ssl: await testSSLConnection(),
                firewall: await testFirewallBlocking(),
                cors: await testCORSPolicy(),
                bandwidth: await testBandwidth()
            };
            
            log('ğŸ“Š è©³ç´°è¨ºæ–­çµæœ', 'info', diagnostics);
            updateConnectionIssues(diagnostics);
        }

        async function testDNSResolution() {
            try {
                const start = performance.now();
                await fetch('/health', { method: 'HEAD' });
                const end = performance.now();
                return { success: true, responseTime: Math.round(end - start) };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function testSSLConnection() {
            try {
                const response = await fetch('https://nennkinn-claud.vercel.app/health');
                return { success: response.ok, protocol: 'HTTPS' };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function testFirewallBlocking() {
            const endpoints = ['/health', '/applications', '/auth/login'];
            const results = [];
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(document.getElementById('baseUrl').value + endpoint, { method: 'HEAD' });
                    results.push({ endpoint, blocked: false, status: response.status });
                } catch (error) {
                    results.push({ endpoint, blocked: true, error: error.message });
                }
            }
            
            return results;
        }

        async function testCORSPolicy() {
            try {
                const response = await fetch(document.getElementById('baseUrl').value + '/health');
                const corsHeaders = {
                    'access-control-allow-origin': response.headers.get('access-control-allow-origin'),
                    'access-control-allow-methods': response.headers.get('access-control-allow-methods'),
                    'access-control-allow-headers': response.headers.get('access-control-allow-headers')
                };
                return { success: true, headers: corsHeaders };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function testBandwidth() {
            const testSize = 1024; // 1KB ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
            const iterations = 5;
            const results = [];
            
            for (let i = 0; i < iterations; i++) {
                const start = performance.now();
                try {
                    await fetch('/health');
                    const end = performance.now();
                    results.push(end - start);
                } catch (error) {
                    results.push(null);
                }
            }
            
            const validResults = results.filter(r => r !== null);
            if (validResults.length > 0) {
                const avgTime = validResults.reduce((a, b) => a + b) / validResults.length;
                const estimatedBandwidth = (testSize / avgTime) * 1000; // KB/s
                return { success: true, bandwidth: Math.round(estimatedBandwidth), avgTime: Math.round(avgTime) };
            } else {
                return { success: false, error: 'ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—' };
            }
        }

        function updateConnectionIssues(diagnostics) {
            const issuesContainer = document.getElementById('connectionIssues');
            issuesContainer.innerHTML = '';
            
            const issues = [];
            
            if (!diagnostics.dns.success) {
                issues.push({ type: 'DNSè§£æ±º', severity: 'high', message: 'DNSè§£æ±ºã«å¤±æ•—ã—ã¾ã—ãŸ' });
            }
            
            if (!diagnostics.ssl.success) {
                issues.push({ type: 'SSLæ¥ç¶š', severity: 'high', message: 'HTTPSæ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™' });
            }
            
            const blockedEndpoints = diagnostics.firewall.filter(r => r.blocked);
            if (blockedEndpoints.length > 0) {
                issues.push({ 
                    type: 'ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«', 
                    severity: 'medium', 
                    message: `${blockedEndpoints.length}å€‹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™` 
                });
            }
            
            if (!diagnostics.cors.success) {
                issues.push({ type: 'CORS', severity: 'medium', message: 'CORSè¨­å®šã«å•é¡ŒãŒã‚ã‚Šã¾ã™' });
            }
            
            if (diagnostics.bandwidth.success && diagnostics.bandwidth.bandwidth < 100) {
                issues.push({ type: 'å¸¯åŸŸå¹…', severity: 'low', message: 'æ¥ç¶šé€Ÿåº¦ãŒä½ä¸‹ã—ã¦ã„ã¾ã™' });
            }
            
            if (issues.length === 0) {
                issuesContainer.innerHTML = '<div class="text-green-600 text-sm">âœ… æ¥ç¶šã«å•é¡Œã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ</div>';
            } else {
                issues.forEach(issue => {
                    const div = document.createElement('div');
                    div.className = `p-3 rounded border-l-4 mb-2 ${
                        issue.severity === 'high' ? 'bg-red-50 border-red-500' :
                        issue.severity === 'medium' ? 'bg-yellow-50 border-yellow-500' :
                        'bg-blue-50 border-blue-500'
                    }`;
                    div.innerHTML = `
                        <div class="font-medium text-sm">${issue.type}</div>
                        <div class="text-sm text-gray-600">${issue.message}</div>
                    `;
                    issuesContainer.appendChild(div);
                });
            }
        }

        async function runSpeedTest() {
            log('âš¡ æ¥ç¶šé€Ÿåº¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™', 'info');
            
            const testSizes = [1, 10, 100]; // KB
            const results = [];
            
            for (const size of testSizes) {
                const times = [];
                for (let i = 0; i < 3; i++) {
                    const start = performance.now();
                    try {
                        await fetch('/health');
                        const end = performance.now();
                        times.push(end - start);
                    } catch (error) {
                        times.push(null);
                    }
                }
                
                const validTimes = times.filter(t => t !== null);
                if (validTimes.length > 0) {
                    const avgTime = validTimes.reduce((a, b) => a + b) / validTimes.length;
                    results.push({ size, avgTime: Math.round(avgTime) });
                }
            }
            
            log('âš¡ é€Ÿåº¦ãƒ†ã‚¹ãƒˆå®Œäº†', 'success', results);
        }

        function updateEndpointDetails() {
            const container = document.getElementById('endpointDetails');
            container.innerHTML = '';
            
            connectionMonitor.endpoints.forEach(endpoint => {
                const recentResults = connectionMonitor.history
                    .filter(h => h.endpoint === endpoint.url)
                    .slice(-10);
                
                const successCount = recentResults.filter(r => r.success).length;
                const successRate = recentResults.length > 0 ? Math.round((successCount / recentResults.length) * 100) : 0;
                const avgResponseTime = recentResults.length > 0 ? 
                    Math.round(recentResults.filter(r => r.success).reduce((sum, r) => sum + r.responseTime, 0) / Math.max(1, successCount)) : 0;
                
                const div = document.createElement('div');
                div.className = 'bg-white border rounded p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-medium">${endpoint.name}</h4>
                        <span class="text-sm ${endpoint.critical ? 'text-red-600' : 'text-gray-500'}">
                            ${endpoint.critical ? 'é‡è¦' : 'é€šå¸¸'}
                        </span>
                    </div>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div>
                            <span class="text-gray-600">æˆåŠŸç‡:</span>
                            <span class="font-medium">${successRate}%</span>
                        </div>
                        <div>
                            <span class="text-gray-600">å¹³å‡å¿œç­”:</span>
                            <span class="font-medium">${avgResponseTime}ms</span>
                        </div>
                        <div>
                            <span class="text-gray-600">ç›´è¿‘çµæœ:</span>
                            <span class="font-medium">${recentResults.length}ä»¶</span>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-2">${endpoint.method} ${endpoint.url}</div>
                `;
                
                container.appendChild(div);
            });
        }

        // åŸºæœ¬ãƒ†ã‚¹ãƒˆé–¢æ•°ï¼ˆå¼·åŒ–ç‰ˆï¼‰
        async function testHealthCheck() {
            log('ğŸ¥ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œä¸­...', 'info');
            updateConnectionStatus('checking');
            
            const result = await makeRequest('GET', '/health');
            if (result.data) {
                document.getElementById('apiStatus').textContent = 'æ­£å¸¸å‹•ä½œä¸­';
                document.getElementById('apiResponseTime').textContent = `å¿œç­”: ${result.responseTime}ms`;
            } else {
                document.getElementById('apiStatus').textContent = 'æ¥ç¶šå¤±æ•—';
                document.getElementById('apiResponseTime').textContent = 'ã‚¨ãƒ©ãƒ¼';
            }
        }

        // è² è·ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½
        async function runLoadTest() {
            log('ğŸš€ è² è·ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™', 'info');
            
            const concurrency = 5; // åŒæ™‚æ¥ç¶šæ•°
            const totalRequests = 20; // ç·ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
            const endpoint = '/health';
            
            const results = [];
            const startTime = performance.now();
            
            // åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Ÿè¡Œ
            const promises = [];
            for (let i = 0; i < concurrency; i++) {
                promises.push(runConcurrentRequests(endpoint, totalRequests / concurrency, results));
            }
            
            await Promise.all(promises);
            
            const endTime = performance.now();
            const totalTime = endTime - startTime;
            
            // çµæœåˆ†æ
            const successfulRequests = results.filter(r => r.success).length;
            const failedRequests = results.length - successfulRequests;
            const averageResponseTime = successfulRequests > 0 ? 
                results.filter(r => r.success).reduce((sum, r) => sum + r.responseTime, 0) / successfulRequests : 0;
            
            const loadTestResults = {
                totalRequests: results.length,
                successful: successfulRequests,
                failed: failedRequests,
                successRate: Math.round((successfulRequests / results.length) * 100),
                averageResponseTime: Math.round(averageResponseTime),
                totalTime: Math.round(totalTime),
                requestsPerSecond: Math.round(results.length / (totalTime / 1000))
            };
            
            log('ğŸš€ è² è·ãƒ†ã‚¹ãƒˆå®Œäº†', 'success', loadTestResults);
        }

        async function runConcurrentRequests(endpoint, count, results) {
            for (let i = 0; i < count; i++) {
                try {
                    const result = await makeRequest('GET', endpoint);
                    results.push({
                        success: result.response?.ok || false,
                        responseTime: result.responseTime || 0,
                        timestamp: new Date()
                    });
                } catch (error) {
                    results.push({
                        success: false,
                        responseTime: 0,
                        error: error.message,
                        timestamp: new Date()
                    });
                }
                
                // å°ã•ãªé…å»¶ã‚’è¿½åŠ ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã®è² è·ã‚’è»½æ¸›
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        // éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆ
        async function runFailoverTest() {
            log('ğŸ”„ éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™', 'info');
            
            const endpoints = connectionMonitor.endpoints.filter(e => e.critical);
            const failoverResults = [];
            
            for (const endpoint of endpoints) {
                log(`ğŸ”„ ${endpoint.name} ã®éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...`, 'info');
                
                // æ•…æ„ã«å¤±æ•—ã•ã›ã‚‹ãƒ†ã‚¹ãƒˆï¼ˆç„¡åŠ¹ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
                const invalidEndpoint = endpoint.url + '-invalid';
                const failureResult = await makeRequest(endpoint.method, invalidEndpoint);
                
                if (!failureResult.response?.ok) {
                    log(`âœ… ${endpoint.name} ã®éšœå®³æ¤œå‡ºã«æˆåŠŸ`, 'success');
                    
                    // è‡ªå‹•å¾©æ—§ãƒ†ã‚¹ãƒˆ
                    const recoveryResult = await attemptAutoReconnect(endpoint);
                    
                    failoverResults.push({
                        endpoint: endpoint.name,
                        failureDetected: true,
                        recoverySuccessful: recoveryResult,
                        recoveryTime: Date.now() // ç°¡æ˜“çš„ãªæ™‚é–“è¨˜éŒ²
                    });
                } else {
                    failoverResults.push({
                        endpoint: endpoint.name,
                        failureDetected: false,
                        recoverySuccessful: false
                    });
                }
            }
            
            log('ğŸ”„ éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆå®Œäº†', 'success', failoverResults);
        }

        // é€£ç¶šç›£è¦–æ©Ÿèƒ½
        async function startContinuousMonitoring() {
            const button = document.getElementById('continuousMonitorBtn');
            
            if (!connectionMonitor.isActive) {
                connectionMonitor.isActive = true;
                connectionMonitor.interval = setInterval(async () => {
                    await checkAllEndpoints();
                    
                    // å•é¡Œæ¤œå‡ºæ™‚ã®è‡ªå‹•å¯¾å¿œ
                    const recentFailures = connectionMonitor.history
                        .slice(-5)
                        .filter(h => !h.success).length;
                    
                    if (recentFailures >= 3) {
                        log('âš ï¸ é€£ç¶šçš„ãªæ¥ç¶šå•é¡Œã‚’æ¤œå‡ºã€è©³ç´°è¨ºæ–­ã‚’å®Ÿè¡Œä¸­...', 'warning');
                        await runConnectionDiagnostics();
                    }
                }, 3000); // 3ç§’é–“éš”
                
                button.textContent = 'ğŸ“¡ ç›£è¦–åœæ­¢';
                button.className = button.className.replace('bg-blue-500', 'bg-red-500').replace('hover:bg-blue-600', 'hover:bg-red-600');
                
                log('ğŸ“¡ é€£ç¶šç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ (3ç§’é–“éš”)', 'info');
            } else {
                stopConnectionMonitor();
                button.textContent = 'ğŸ“¡ é€£ç¶šç›£è¦–é–‹å§‹';
                button.className = button.className.replace('bg-red-500', 'bg-blue-500').replace('hover:bg-red-600', 'hover:bg-blue-600');
            }
        }

        async function testLogin() {
            log('ğŸ” ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...', 'info');
            const credentials = {
                email: 'admin@disability-pension.jp',
                password: 'admin123'
            };
            const result = await makeRequest('POST', '/auth/login', credentials);
            
            if (result.data && result.data.token) {
                document.getElementById('authToken').value = result.data.token;
                document.getElementById('authStatus').textContent = 'ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½';
                document.getElementById('authResponseTime').textContent = `å¿œç­”: ${result.responseTime}ms`;
                log('ğŸ‰ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è‡ªå‹•è¨­å®šã—ã¾ã—ãŸ', 'success');
            } else {
                document.getElementById('authStatus').textContent = 'èªè¨¼ã‚¨ãƒ©ãƒ¼';
                document.getElementById('authResponseTime').textContent = 'ã‚¨ãƒ©ãƒ¼';
            }
        }

        async function testApplications() {
            log('ğŸ“‹ ç”³è«‹ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...', 'info');
            const result = await makeRequest('GET', '/applications?limit=3');
            
            if (result.data && result.data.applications) {
                document.getElementById('dbStatus').textContent = `æ¥ç¶šæ¸ˆã¿ (${result.data.applications.length}ä»¶)`;
            } else {
                document.getElementById('dbStatus').textContent = 'æ¥ç¶šã‚¨ãƒ©ãƒ¼';
            }
        }

        async function testDatabaseConnection() {
            log('ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆä¸­...', 'info');
            
            try {
                // ApplicationAPIãŒåˆ©ç”¨å¯èƒ½ã‹ç¢ºèª
                if (typeof ApplicationAPI !== 'undefined') {
                    const result = await ApplicationAPI.getApplications({ limit: 1 });
                    log('âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæˆåŠŸ', 'success', result);
                    document.getElementById('dbStatus').textContent = 'æ¥ç¶šæ¸ˆã¿';
                } else {
                    // APIçµŒç”±ã§ãƒ†ã‚¹ãƒˆ
                    await testApplications();
                }
            } catch (error) {
                log(`âŒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error', error);
                document.getElementById('dbStatus').textContent = 'æ¥ç¶šã‚¨ãƒ©ãƒ¼';
            }
        }

        async function sendCustomRequest() {
            const method = document.getElementById('method').value;
            const endpoint = document.getElementById('endpoint').value;
            const bodyText = document.getElementById('requestBody').value;

            let body = null;
            if (bodyText.trim()) {
                try {
                    body = JSON.parse(bodyText);
                } catch (error) {
                    log(`âŒ JSONãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                    return;
                }
            }

            await makeRequest(method, endpoint, body);
        }

        // project-unified è¨ºæ–­é–¢æ•°
        async function testUnifiedPageLoad() {
            log('ğŸ” project-unified.html ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                const response = await fetch('/project-unified.html');
                if (response.ok) {
                    const html = await response.text();
                    log('âœ… project-unified.html èª­ã¿è¾¼ã¿æˆåŠŸ', 'success');
                    
                    // JavaScriptä¾å­˜é–¢ä¿‚ã‚’ãƒã‚§ãƒƒã‚¯
                    if (html.includes('js/application-api.js')) {
                        log('ğŸ“ application-api.js ã®ä¾å­˜é–¢ä¿‚ã‚’ç¢ºèª', 'info');
                        await testApplicationApiLoad();
                    }
                    
                    document.getElementById('unifiedStatus').textContent = 'ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æˆåŠŸ';
                } else {
                    log(`âŒ project-unified.html èª­ã¿è¾¼ã¿å¤±æ•—: ${response.status}`, 'error');
                    document.getElementById('unifiedStatus').textContent = 'èª­ã¿è¾¼ã¿å¤±æ•—';
                }
            } catch (error) {
                log(`ğŸ’¥ ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                document.getElementById('unifiedStatus').textContent = 'æ¥ç¶šã‚¨ãƒ©ãƒ¼';
            }
        }

        async function testApplicationApiLoad() {
            log('ğŸ”§ application-api.js ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                const response = await fetch('/js/application-api.js');
                if (response.ok) {
                    const jsCode = await response.text();
                    log('âœ… application-api.js ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª', 'success');
                    
                    // APIãƒ™ãƒ¼ã‚¹URLè¨­å®šã‚’ãƒã‚§ãƒƒã‚¯
                    if (jsCode.includes('getAPIBaseURL')) {
                        log('ğŸ“ APIè¨­å®šé–¢æ•°ã‚’ç¢ºèª', 'debug');
                    }
                    
                    // ApplicationAPIã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å­˜åœ¨ç¢ºèª
                    if (typeof ApplicationAPI !== 'undefined') {
                        log('âœ… ApplicationAPI ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåˆ©ç”¨å¯èƒ½', 'success');
                    } else {
                        log('âš ï¸ ApplicationAPI ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæœªèª­ã¿è¾¼ã¿', 'warning');
                    }
                } else {
                    log(`âŒ application-api.js èª­ã¿è¾¼ã¿å¤±æ•—: ${response.status}`, 'error');
                }
            } catch (error) {
                log(`ğŸ’¥ application-api.js èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function simulateEditMode() {
            log('ğŸ­ ç·¨é›†ãƒ¢ãƒ¼ãƒ‰(?edit=1) æ¨¡æ“¬ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            const applicationId = document.getElementById('testApplicationId').value || '1';
            
            try {
                // ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãƒ†ã‚¹ãƒˆ
                log(`ğŸ“Š ç”³è«‹ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ (ID: ${applicationId})`, 'info');
                const result = await makeRequest('GET', `/applications/${applicationId}`);
                
                if (result.data) {
                    log('âœ… ç”³è«‹ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ', 'success', result.data);
                    document.getElementById('unifiedStatus').textContent = 'ç·¨é›†ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ';
                    
                    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¸ã®ä¿å­˜ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    localStorage.setItem(`application_${applicationId}`, JSON.stringify(result.data));
                    log('ğŸ’¾ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã—ã¾ã—ãŸ', 'info');
                } else {
                    log('âŒ ç”³è«‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                    document.getElementById('unifiedStatus').textContent = 'ãƒ‡ãƒ¼ã‚¿ä¸æ˜';
                }
            } catch (error) {
                log(`ğŸ’¥ ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ¨¡æ“¬ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                document.getElementById('unifiedStatus').textContent = 'ã‚¨ãƒ©ãƒ¼';
            }
        }

        async function testLocalStorageData() {
            log('ğŸ—„ï¸ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ç¢ºèª', 'info');
            
            const applicationId = document.getElementById('testApplicationId').value || '1';
            const storageKey = `application_${applicationId}`;
            const storedData = localStorage.getItem(storageKey);
            
            if (storedData) {
                try {
                    const parsedData = JSON.parse(storedData);
                    log(`âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ç™ºè¦‹ (${storageKey})`, 'success', parsedData);
                } catch (error) {
                    log(`âŒ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                }
            } else {
                log(`âš ï¸ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“ (${storageKey})`, 'warning');
                
                // å…¨ã¦ã®ã‚­ãƒ¼ã‚’èª¿æŸ»
                const allKeys = Object.keys(localStorage);
                if (allKeys.length > 0) {
                    log(`ğŸ“‹ å­˜åœ¨ã™ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚­ãƒ¼:`, 'info', allKeys);
                } else {
                    log('ğŸ“‹ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ç©ºã§ã™', 'info');
                }
            }
        }

        // å¼·åŒ–ã•ã‚ŒãŸproject-unifiedè¨ºæ–­é–¢æ•°
        async function testProjectUnifiedDirectly() {
            log('ğŸ¯ project-unified.html ç›´æ¥ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                // iframeå†…ã§project-unified.htmlã‚’èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = '/project-unified.html?edit=1';
                
                document.body.appendChild(iframe);
                
                const loadPromise = new Promise((resolve, reject) => {
                    iframe.onload = () => resolve(iframe);
                    iframe.onerror = () => reject(new Error('iframeèª­ã¿è¾¼ã¿å¤±æ•—'));
                    setTimeout(() => reject(new Error('èª­ã¿è¾¼ã¿ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ')), 10000);
                });
                
                const loadedIframe = await loadPromise;
                log('âœ… project-unified.html iframeèª­ã¿è¾¼ã¿æˆåŠŸ', 'success');
                
                // JavaScriptå®Ÿè¡Œã‚¨ãƒ©ãƒ¼ã‚’ãƒã‚§ãƒƒã‚¯
                setTimeout(() => {
                    try {
                        const iframeDoc = loadedIframe.contentDocument;
                        if (iframeDoc) {
                            const scripts = iframeDoc.querySelectorAll('script');
                            log(`ğŸ“Š ç™ºè¦‹ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ: ${scripts.length}å€‹`, 'info');
                            
                            // application-api.jsã®å­˜åœ¨ç¢ºèª
                            const apiScript = Array.from(scripts).find(s => s.src.includes('application-api.js'));
                            if (apiScript) {
                                log('âœ… application-api.js ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ç¢ºèª', 'success');
                            } else {
                                log('âš ï¸ application-api.js ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'warning');
                            }
                        }
                    } catch (error) {
                        log(`âš ï¸ iframeå†…å®¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™: ${error.message}`, 'warning');
                    }
                    
                    document.body.removeChild(loadedIframe);
                }, 2000);
                
            } catch (error) {
                log(`âŒ project-unifiedç›´æ¥ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function simulateFormSubmission() {
            log('ğŸ“ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ¨¡æ“¬ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                // ç”³è«‹ãƒ‡ãƒ¼ã‚¿ã®æ¨¡æ“¬ç”Ÿæˆ
                const mockFormData = {
                    applicantName: 'ãƒ†ã‚¹ãƒˆå¤ªéƒ',
                    applicantNameKana: 'ãƒ†ã‚¹ãƒˆã‚¿ãƒ­ã‚¦',
                    birthDate: '1990-01-01',
                    gender: 'male',
                    phoneNumber: '090-1234-5678',
                    email: 'test@example.com',
                    address: 'æ±äº¬éƒ½æ–°å®¿åŒºãƒ†ã‚¹ãƒˆ1-1-1',
                    disabilityType: 'mental',
                    disabilityGrade: 2,
                    status: 'draft'
                };
                
                log('ğŸ“Š æ¨¡æ“¬ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ', 'info', mockFormData);
                
                // POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã®é€ä¿¡ãƒ†ã‚¹ãƒˆ
                const result = await makeRequest('POST', '/applications', mockFormData);
                
                if (result.data) {
                    log('âœ… ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ¨¡æ“¬æˆåŠŸ', 'success', result.data);
                } else {
                    log('âŒ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ¨¡æ“¬å¤±æ•—', 'error');
                }
                
            } catch (error) {
                log(`ğŸ’¥ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ¨¡æ“¬ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function testDOMManipulation() {
            log('ğŸ¨ DOMæ“ä½œãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                // ãƒ†ã‚¹ãƒˆç”¨ã®DOMè¦ç´ ã‚’ä½œæˆ
                const testContainer = document.createElement('div');
                testContainer.id = 'test-container';
                testContainer.style.display = 'none';
                document.body.appendChild(testContainer);
                
                // project-unified.htmlã®å…¸å‹çš„ãªDOMæ§‹é€ ã‚’æ¨¡æ“¬
                testContainer.innerHTML = `
                    <form id="application-form">
                        <input type="text" id="applicantName" value="ãƒ†ã‚¹ãƒˆå¤ªéƒ">
                        <input type="email" id="email" value="test@example.com">
                        <select id="disabilityType">
                            <option value="mental">ç²¾ç¥éšœå®³</option>
                            <option value="physical">èº«ä½“éšœå®³</option>
                        </select>
                    </form>
                    <div id="error-display"></div>
                    <div id="loading-indicator" style="display: none;">èª­ã¿è¾¼ã¿ä¸­...</div>
                `;
                
                // DOMæ“ä½œã®ãƒ†ã‚¹ãƒˆ
                const form = testContainer.querySelector('#application-form');
                const nameInput = testContainer.querySelector('#applicantName');
                const emailInput = testContainer.querySelector('#email');
                
                if (form && nameInput && emailInput) {
                    log('âœ… DOMè¦ç´ ã®ä½œæˆã¨å–å¾—æˆåŠŸ', 'success');
                    
                    // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãƒ†ã‚¹ãƒˆ
                    const formData = new FormData(form);
                    const formObject = Object.fromEntries(formData);
                    log('ğŸ“Š ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ', 'info', formObject);
                    
                    // å‹•çš„ãªå€¤ã®å¤‰æ›´ãƒ†ã‚¹ãƒˆ
                    nameInput.value = 'å¤‰æ›´ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆå¤ªéƒ';
                    emailInput.value = 'changed@example.com';
                    
                    log('âœ… DOMå€¤å¤‰æ›´ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'success', {
                        name: nameInput.value,
                        email: emailInput.value
                    });
                } else {
                    log('âŒ DOMè¦ç´ ã®å–å¾—ã«å¤±æ•—', 'error');
                }
                
                // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                document.body.removeChild(testContainer);
                log('ğŸ§¹ ãƒ†ã‚¹ãƒˆç”¨DOMè¦ç´ ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—', 'info');
                
            } catch (error) {
                log(`ğŸ’¥ DOMæ“ä½œãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function validateProjectUnifiedIntegrity() {
            log('ğŸ” project-unified.html æ•´åˆæ€§æ¤œè¨¼é–‹å§‹', 'info');
            
            try {
                // ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã¨å†…å®¹ã®ç¢ºèª
                const response = await fetch('/project-unified.html');
                const html = await response.text();
                
                const validationResults = {
                    fileExists: response.ok,
                    hasApplicationApiScript: html.includes('js/application-api.js'),
                    hasDOMContentLoadedListener: html.includes('DOMContentLoaded'),
                    hasAPIBaseURLDefined: html.includes('API_BASE_URL'),
                    hasErrorHandling: html.includes('catch') || html.includes('error'),
                    hasFormElements: html.includes('<form') || html.includes('input'),
                    hasJavaScriptFunctions: html.includes('function ') || html.includes('async '),
                    fileSize: html.length
                };
                
                log('ğŸ“Š æ•´åˆæ€§æ¤œè¨¼çµæœ', 'info', validationResults);
                
                // æ¤œè¨¼çµæœã®è©•ä¾¡
                const issues = [];
                if (!validationResults.hasApplicationApiScript) {
                    issues.push('application-api.js ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
                if (!validationResults.hasDOMContentLoadedListener) {
                    issues.push('DOMContentLoadedã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
                if (!validationResults.hasAPIBaseURLDefined) {
                    issues.push('API_BASE_URLå®šç¾©ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
                if (!validationResults.hasErrorHandling) {
                    issues.push('ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒä¸ååˆ†ã§ã™');
                }
                
                if (issues.length === 0) {
                    log('âœ… project-unified.html æ•´åˆæ€§æ¤œè¨¼æˆåŠŸ', 'success');
                    document.getElementById('unifiedStatus').textContent = 'æ•´åˆæ€§OK';
                } else {
                    log(`âš ï¸ ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œç‚¹:`, 'warning', issues);
                    document.getElementById('unifiedStatus').textContent = `å•é¡Œ${issues.length}ä»¶`;
                }
                
            } catch (error) {
                log(`ğŸ’¥ æ•´åˆæ€§æ¤œè¨¼ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                document.getElementById('unifiedStatus').textContent = 'æ¤œè¨¼ã‚¨ãƒ©ãƒ¼';
            }
        }

        // è‡ªå‹•è¨ºæ–­ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
        async function runFullDiagnosis() {
            const button = document.getElementById('diagnosisButton');
            const progress = document.getElementById('diagnosisProgress');
            const status = document.getElementById('diagnosisStatus');
            const results = document.getElementById('diagnosisResults');
            
            button.disabled = true;
            button.textContent = 'è¨ºæ–­å®Ÿè¡Œä¸­...';
            results.innerHTML = '';
            
            const steps = [
                { name: 'ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šç¢ºèª', func: testHealthCheck, weight: 15 },
                { name: 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š', func: testDatabaseConnection, weight: 15 },
                { name: 'èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ç¢ºèª', func: testLogin, weight: 10 },
                { name: 'project-unifiedèª­ã¿è¾¼ã¿', func: testUnifiedPageLoad, weight: 20 },
                { name: 'APIä¾å­˜é–¢ä¿‚ç¢ºèª', func: testApplicationApiLoad, weight: 15 },
                { name: 'ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸', func: testLocalStorageData, weight: 10 },
                { name: 'ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ¨¡æ“¬', func: simulateEditMode, weight: 15 }
            ];
            
            let totalProgress = 0;
            
            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                status.textContent = `${step.name}ã‚’å®Ÿè¡Œä¸­... (${i + 1}/${steps.length})`;
                
                const startTime = Date.now();
                try {
                    await step.func();
                    const duration = Date.now() - startTime;
                    addDiagnosisResult(step.name, 'æˆåŠŸ', duration, 'success');
                } catch (error) {
                    const duration = Date.now() - startTime;
                    addDiagnosisResult(step.name, `å¤±æ•—: ${error.message}`, duration, 'error');
                }
                
                totalProgress += step.weight;
                progress.style.width = `${totalProgress}%`;
                
                // å°‘ã—å¾…æ©Ÿã—ã¦UIã‚’æ›´æ–°
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            status.textContent = 'å®Œå…¨è¨ºæ–­å®Œäº†';
            button.disabled = false;
            button.textContent = 'ğŸš€ å®Œå…¨è¨ºæ–­é–‹å§‹';
            
            log('ğŸ‰ å®Œå…¨è¨ºæ–­ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å®Œäº†', 'success');
        }

        async function runQuickDiagnosis() {
            log('âš¡ ã‚¯ã‚¤ãƒƒã‚¯è¨ºæ–­é–‹å§‹', 'info');
            
            const quickSteps = [
                testHealthCheck,
                testApplicationApiLoad,
                simulateEditMode
            ];
            
            for (const step of quickSteps) {
                try {
                    await step();
                } catch (error) {
                    log(`ã‚¯ã‚¤ãƒƒã‚¯è¨ºæ–­ã‚¹ãƒ†ãƒƒãƒ—ã§ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                }
            }
            
            log('âš¡ ã‚¯ã‚¤ãƒƒã‚¯è¨ºæ–­å®Œäº†', 'success');
        }

        function addDiagnosisResult(stepName, result, duration, type) {
            const results = document.getElementById('diagnosisResults');
            const div = document.createElement('div');
            div.className = `p-3 rounded border-l-4 ${
                type === 'success' ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'
            }`;
            
            div.innerHTML = `
                <div class="flex justify-between items-center">
                    <span class="font-medium">${stepName}</span>
                    <span class="text-sm text-gray-500">${duration}ms</span>
                </div>
                <div class="text-sm ${type === 'success' ? 'text-green-700' : 'text-red-700'}">${result}</div>
            `;
            
            results.appendChild(div);
        }

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–æ©Ÿèƒ½
        async function measurePageLoadTime() {
            log('ğŸ“Š ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿é€Ÿåº¦æ¸¬å®šé–‹å§‹', 'info');
            
            const startTime = performance.now();
            
            try {
                const response = await fetch('/project-unified.html');
                const html = await response.text();
                const endTime = performance.now();
                const loadTime = Math.round(endTime - startTime);
                
                document.getElementById('loadTimeMetric').textContent = loadTime;
                appendPerformanceLog(`ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿: ${loadTime}ms`);
                
                log(`ğŸ“Š ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†: ${loadTime}ms`, 'success');
            } catch (error) {
                log(`ğŸ’¥ ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ¸¬å®šã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        async function measureAPIResponseTime() {
            log('ğŸŒ APIå¿œç­”æ™‚é–“æ¸¬å®šé–‹å§‹', 'info');
            
            const endpoints = ['/health', '/applications?limit=1'];
            const responseTimes = [];
            
            for (const endpoint of endpoints) {
                const startTime = performance.now();
                try {
                    await makeRequest('GET', endpoint);
                    const endTime = performance.now();
                    const responseTime = Math.round(endTime - startTime);
                    responseTimes.push(responseTime);
                    appendPerformanceLog(`${endpoint}: ${responseTime}ms`);
                } catch (error) {
                    appendPerformanceLog(`${endpoint}: ã‚¨ãƒ©ãƒ¼`);
                }
            }
            
            if (responseTimes.length > 0) {
                const averageTime = Math.round(responseTimes.reduce((a, b) => a + b) / responseTimes.length);
                document.getElementById('apiResponseMetric').textContent = averageTime;
                log(`ğŸŒ APIå¹³å‡å¿œç­”æ™‚é–“: ${averageTime}ms`, 'success');
            }
        }

        async function analyzeMemoryUsage() {
            log('ğŸ’¾ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡åˆ†æé–‹å§‹', 'info');
            
            if (performance.memory) {
                const memory = performance.memory;
                const usedMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);
                const totalMB = Math.round(memory.totalJSHeapSize / 1024 / 1024);
                const limitMB = Math.round(memory.jsHeapSizeLimit / 1024 / 1024);
                
                document.getElementById('memoryUsageMetric').textContent = usedMB;
                
                appendPerformanceLog(`ä½¿ç”¨ä¸­: ${usedMB}MB / åˆè¨ˆ: ${totalMB}MB / ä¸Šé™: ${limitMB}MB`);
                
                log(`ğŸ’¾ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ${usedMB}MB`, 'success', {
                    used: usedMB,
                    total: totalMB,
                    limit: limitMB
                });
            } else {
                log('âš ï¸ ãƒ¡ãƒ¢ãƒªæƒ…å ±ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'warning');
                appendPerformanceLog('ãƒ¡ãƒ¢ãƒªæƒ…å ±ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
            }
        }

        function appendPerformanceLog(message) {
            const log = document.getElementById('performanceLog');
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            const div = document.createElement('div');
            div.textContent = `[${timestamp}] ${message}`;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }

        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–æ©Ÿèƒ½
        function toggleConsoleCapture() {
            const button = document.getElementById('consoleToggle');
            const output = document.getElementById('consoleOutput');
            
            if (!consoleCapturing) {
                // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–é–‹å§‹
                originalConsole.log = console.log;
                originalConsole.error = console.error;
                originalConsole.warn = console.warn;
                originalConsole.info = console.info;
                
                console.log = function(...args) {
                    originalConsole.log.apply(console, args);
                    appendConsoleLog('LOG', args.join(' '), '#4ade80');
                };
                
                console.error = function(...args) {
                    originalConsole.error.apply(console, args);
                    appendConsoleLog('ERROR', args.join(' '), '#ef4444');
                };
                
                console.warn = function(...args) {
                    originalConsole.warn.apply(console, args);
                    appendConsoleLog('WARN', args.join(' '), '#f59e0b');
                };
                
                console.info = function(...args) {
                    originalConsole.info.apply(console, args);
                    appendConsoleLog('INFO', args.join(' '), '#3b82f6');
                };
                
                consoleCapturing = true;
                button.textContent = 'ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–åœæ­¢';
                button.className = button.className.replace('bg-green-500', 'bg-red-500').replace('hover:bg-green-600', 'hover:bg-red-600');
                output.innerHTML = '<div style="color: #4ade80;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–é–‹å§‹...</div>';
                
                log('ğŸ“Š ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'info');
            } else {
                // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–åœæ­¢
                console.log = originalConsole.log;
                console.error = originalConsole.error;
                console.warn = originalConsole.warn;
                console.info = originalConsole.info;
                
                consoleCapturing = false;
                button.textContent = 'ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–é–‹å§‹';
                button.className = button.className.replace('bg-red-500', 'bg-green-500').replace('hover:bg-red-600', 'hover:bg-green-600');
                
                log('ğŸ“Š ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–ã‚’åœæ­¢ã—ã¾ã—ãŸ', 'info');
            }
        }
        
        function appendConsoleLog(level, message, color) {
            const output = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            const div = document.createElement('div');
            div.style.color = color;
            div.textContent = `[${timestamp}] [${level}] ${message}`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }
        
        function clearConsoleLog() {
            document.getElementById('consoleOutput').innerHTML = 'ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç›£è¦–å¾…æ©Ÿä¸­...';
        }

        // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–æ©Ÿèƒ½
        function toggleNetworkCapture() {
            const button = document.getElementById('networkToggle');
            const output = document.getElementById('networkOutput');
            
            if (!networkCapturing) {
                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–é–‹å§‹
                originalFetch = window.fetch;
                
                window.fetch = async function(...args) {
                    const startTime = Date.now();
                    const url = args[0];
                    const options = args[1] || {};
                    
                    appendNetworkLog(`ğŸš€ ${options.method || 'GET'} ${url}`, '#3b82f6');
                    
                    try {
                        const response = await originalFetch.apply(this, args);
                        const duration = Date.now() - startTime;
                        const status = response.status;
                        const color = status >= 200 && status < 300 ? '#4ade80' : '#ef4444';
                        
                        appendNetworkLog(`${status >= 200 && status < 300 ? 'âœ…' : 'âŒ'} ${status} ${url} (${duration}ms)`, color);
                        
                        return response;
                    } catch (error) {
                        const duration = Date.now() - startTime;
                        appendNetworkLog(`ğŸ’¥ ERROR ${url} (${duration}ms): ${error.message}`, '#ef4444');
                        throw error;
                    }
                };
                
                networkCapturing = true;
                button.textContent = 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–åœæ­¢';
                button.className = button.className.replace('bg-blue-500', 'bg-red-500').replace('hover:bg-blue-600', 'hover:bg-red-600');
                output.innerHTML = '<div class="text-blue-500 text-sm">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–é–‹å§‹...</div>';
                
                log('ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'info');
            } else {
                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–åœæ­¢
                if (originalFetch) {
                    window.fetch = originalFetch;
                }
                
                networkCapturing = false;
                button.textContent = 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–é–‹å§‹';
                button.className = button.className.replace('bg-red-500', 'bg-blue-500').replace('hover:bg-red-600', 'hover:bg-blue-600');
                
                log('ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–ã‚’åœæ­¢ã—ã¾ã—ãŸ', 'info');
            }
        }
        
        function appendNetworkLog(message, color) {
            const output = document.getElementById('networkOutput');
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            const div = document.createElement('div');
            div.className = 'text-sm py-1';
            div.style.color = color;
            div.textContent = `[${timestamp}] ${message}`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }
        
        function clearNetworkLog() {
            document.getElementById('networkOutput').innerHTML = '<div class="text-gray-500 text-sm">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–å¾…æ©Ÿä¸­...</div>';
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            log('ğŸ”§ çµ±åˆãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã‚’åˆæœŸåŒ–ä¸­...', 'info');
            
            // è‡ªå‹•çš„ã«ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
            await testHealthCheck();
            
            // ApplicationAPIã®çŠ¶æ…‹ã‚’ç¢ºèª
            if (typeof ApplicationAPI !== 'undefined') {
                log('âœ… ApplicationAPIãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ', 'success');
            } else {
                log('âš ï¸ ApplicationAPIãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'warning');
                log('ğŸ’¡ js/application-api.jsãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„', 'info');
            }
            
            // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
            window.addEventListener('error', function(event) {
                log(`ğŸ› JavaScriptã‚¨ãƒ©ãƒ¼: ${event.message}`, 'error', {
                    filename: event.filename,
                    line: event.lineno,
                    column: event.colno,
                    error: event.error?.stack
                });
            });
            
            // Enter ã‚­ãƒ¼ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
            document.getElementById('endpoint').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendCustomRequest();
                }
            });
            
            log('âœ… çµ±åˆãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã®åˆæœŸåŒ–å®Œäº†', 'success');
        });
    </script>
</body>
</html>