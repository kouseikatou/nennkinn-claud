<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新規申請作成 - 障害年金管理システム</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif']
                    },
                    colors: {
                        'notion-gray': {
                            50: '#fbfbfb',
                            100: '#f7f6f3',
                            200: '#ebeae6',
                            300: '#d1cfc8',
                            400: '#9b9a97',
                            500: '#787774',
                            600: '#5e5d5a',
                            700: '#37352f',
                            800: '#25241f',
                            900: '#1f1e1a'
                        },
                        'saas': {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a'
                        },
                        'primary': {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a'
                        },
                        'linear-blue': {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1'
                        }
                    },
                    boxShadow: {
                        'notion': '0 1px 2px rgba(0, 0, 0, 0.04)',
                        'notion-hover': '0 2px 8px rgba(0, 0, 0, 0.08)',
                        'linear': '0 1px 3px rgba(0, 0, 0, 0.05), 0 10px 25px rgba(0, 0, 0, 0.05)',
                        'saas': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-notion-gray-50 font-sans antialiased">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="bg-white/80 backdrop-blur-md border-b border-notion-gray-200/60 px-6 py-4 sticky top-0 z-40">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-linear-blue-500 to-linear-blue-600 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h1 class="text-xl font-semibold text-notion-gray-800">障害年金管理システム</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2 px-3 py-2 bg-notion-gray-100 rounded-lg">
                        <div class="w-6 h-6 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center text-xs font-medium text-white">田</div>
                        <span class="text-sm font-medium text-notion-gray-700">田中太郎</span>
                    </div>
                    <button class="p-2 text-notion-gray-500 hover:text-notion-gray-700 hover:bg-notion-gray-100 rounded-lg transition-all duration-200">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <div class="flex">
            <!-- Sidebar -->
            <div class="w-64 bg-white border-r border-saas-200 shadow-saas min-h-screen">
                <nav class="p-6">
                    <div class="mb-8">
                        <div class="text-xs font-semibold text-saas-400 uppercase tracking-wider mb-4">ナビゲーション</div>
                        <ul class="space-y-2">
                            <li>
                                <a href="index.html" class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl text-saas-700 hover:bg-saas-50 hover:text-saas-900 transition-all duration-200">
                                    <div class="mr-3 flex-shrink-0">
                                        <svg class="h-5 w-5 text-saas-500 group-hover:text-saas-700" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                                        </svg>
                                    </div>
                                    ダッシュボード
                                </a>
                            </li>
                            <li>
                                <a href="projects.html" class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl bg-primary-50 text-primary-700 border border-primary-200">
                                    <div class="mr-3 flex-shrink-0">
                                        <svg class="h-5 w-5 text-primary-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 3a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
                                        </svg>
                                    </div>
                                    申請管理
                                </a>
                            </li>
                            <li>
                                <a href="logs.html" class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl text-saas-700 hover:bg-saas-50 hover:text-saas-900 transition-all duration-200">
                                    <div class="mr-3 flex-shrink-0">
                                        <svg class="h-5 w-5 text-saas-500 group-hover:text-saas-700" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd"/>
                                        </svg>
                                    </div>
                                    アクティビティ
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>

            <!-- Main Content -->
            <main class="flex-1 p-8 max-w-6xl mx-auto">
                <div class="space-y-8">
                    <!-- Page Header -->
                    <div class="flex items-center justify-between mb-8">
                        <div class="text-center flex-1">
                            <h1 id="pageTitle" class="text-3xl font-bold text-notion-gray-800 mb-2">新規申請作成</h1>
                            <p id="pageSubtitle" class="text-notion-gray-500">障害年金申請の情報を入力してください</p>
                        </div>
                        <div id="editModeIndicator" class="hidden px-4 py-2 bg-blue-100 text-blue-800 rounded-lg border border-blue-300 text-sm font-medium">
                            <div class="flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                </svg>
                                <span>編集モード</span>
                            </div>
                        </div>
                    </div>

                    <!-- Form -->
                    <form class="space-y-8" onsubmit="event.preventDefault(); saveApplication(); return false;">
                        <!-- 申請者基本情報 -->
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl border border-notion-gray-200/60 shadow-notion overflow-hidden">
                            <div class="bg-blue-50 px-6 py-4 border-b border-notion-gray-200/60">
                                <h2 class="text-xl font-semibold text-notion-gray-800 flex items-center">
                                    <div class="w-6 h-6 bg-blue-500 rounded-lg flex items-center justify-center mr-3">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                                        </svg>
                                    </div>
                                    申請者基本情報
                                </h2>
                            </div>
                            
                            <div class="p-6 space-y-6">
                                <!-- 名前・フリガナ -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            氏名 <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="田中太郎">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            フリガナ <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="タナカタロウ">
                                    </div>
                                </div>

                                <!-- 年齢・性別・生年月日 -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            年齢 <span class="text-red-500">*</span>
                                        </label>
                                        <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="42">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            性別
                                        </label>
                                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                            <option value="">選択してください</option>
                                            <option value="male">男性</option>
                                            <option value="female">女性</option>
                                            <option value="other">その他</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            生年月日
                                        </label>
                                        <input type="date" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                    </div>
                                </div>

                                <!-- 基礎年金番号・マイナンバー -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            基礎年金番号 <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="1234-567890">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            マイナンバー <span class="text-red-500">*</span>
                                        </label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="123456789012" pattern="[0-9]{12}" maxlength="12">
                                    </div>
                                </div>

                                <!-- 連絡先 -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            電話番号
                                        </label>
                                        <input type="tel" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="03-1234-5678">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            メールアドレス
                                        </label>
                                        <input type="email" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="example@example.com">
                                    </div>
                                </div>

                                <!-- 住所 -->
                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                        住所
                                    </label>
                                    <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="東京都新宿区西新宿1-1-1">
                                </div>
                            </div>
                        </div>

                        <!-- 家族情報 -->
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl border border-notion-gray-200/60 shadow-notion overflow-hidden">
                            <div class="bg-green-50 px-6 py-4 border-b border-notion-gray-200/60">
                                <h2 class="text-xl font-semibold text-notion-gray-800 flex items-center">
                                    <div class="w-6 h-6 bg-green-500 rounded-lg flex items-center justify-center mr-3">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"/>
                                            <path d="M6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/>
                                        </svg>
                                    </div>
                                    家族情報
                                </h2>
                            </div>
                            
                            <div class="p-6 space-y-6">
                                <!-- 配偶者有無 -->
                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-3">配偶者の有無</label>
                                    <div class="flex space-x-6">
                                        <label class="flex items-center">
                                            <input type="radio" name="hasSpouse" value="true" class="mr-2">
                                            <span class="text-sm text-notion-gray-700">有り</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="radio" name="hasSpouse" value="false" class="mr-2">
                                            <span class="text-sm text-notion-gray-700">無し</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- 配偶者情報 -->
                                <div id="spouseInfo" class="hidden">
                                    <h3 class="text-lg font-semibold text-notion-gray-700 mb-4">配偶者情報</h3>
                                    
                                    <!-- 基本情報 -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">氏名 <span class="text-red-500">*</span></label>
                                            <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="田中花子">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">フリガナ <span class="text-red-500">*</span></label>
                                            <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="タナカハナコ">
                                        </div>
                                    </div>

                                    <!-- 個人識別情報 -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">マイナンバー <span class="text-red-500">*</span></label>
                                            <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="123456789012" pattern="[0-9]{12}" maxlength="12">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">基礎年金番号 <span class="text-red-500">*</span></label>
                                            <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="1234-567890">
                                        </div>
                                    </div>

                                    <!-- 基本属性 -->
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">生年月日 <span class="text-red-500">*</span></label>
                                            <input type="date" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">年齢</label>
                                            <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="38" min="0" max="150">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">性別</label>
                                            <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                                <option value="">選択してください</option>
                                                <option value="male">男性</option>
                                                <option value="female">女性</option>
                                                <option value="other">その他</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- 年収情報 -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">年収（前年度）</label>
                                            <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="3000000" min="0">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">年収（前々年度）</label>
                                            <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="2900000" min="0">
                                        </div>
                                    </div>

                                    <!-- 加算対象情報 -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">配偶者加算対象</label>
                                            <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                                <option value="">選択してください</option>
                                                <option value="yes">対象</option>
                                                <option value="no">対象外</option>
                                                <option value="unknown">不明</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- 住所情報 -->
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">住所</label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="東京都新宿区西新宿1-1-1">
                                    </div>

                                    <!-- 連絡先情報 -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">電話番号</label>
                                            <input type="tel" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="03-1234-5678">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">メールアドレス</label>
                                            <input type="email" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="hanako@example.com">
                                        </div>
                                    </div>
                                </div>

                                <!-- 子ども情報 -->
                                <div>
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-semibold text-notion-gray-700">子ども情報</h3>
                                        <button type="button" class="px-4 py-2 bg-linear-blue-600 hover:bg-linear-blue-700 text-white text-sm font-medium rounded-lg transition-all duration-200 flex items-center space-x-2" onclick="addChild()">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                            </svg>
                                            <span>子どもを追加</span>
                                        </button>
                                    </div>
                                    <div id="childrenList" class="space-y-4">
                                        <div class="text-sm text-notion-gray-500">「子どもを追加」ボタンを押して子ども情報を入力してください</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        

                        <!-- 傷病情報 -->
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl border border-notion-gray-200/60 shadow-notion overflow-hidden">
                            <div class="bg-red-50 px-6 py-4 border-b border-notion-gray-200/60">
                                <h2 class="text-xl font-semibold text-notion-gray-800 flex items-center">
                                    <div class="w-6 h-6 bg-red-500 rounded-lg flex items-center justify-center mr-3">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
                                        </svg>
                                    </div>
                                    傷病情報
                                </h2>
                            </div>
                            
                            <div class="p-6 space-y-6">
                                <!-- 基本情報 -->
                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                        傷病名 <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="うつ病、統合失調症など">
                                </div>
                                
                                <!-- 現症日詳細 -->
                                <div class="bg-purple-50 p-6 rounded-lg border border-purple-200">
                                    <h3 class="text-lg font-medium text-notion-gray-800 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-purple-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 3a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
                                        </svg>
                                        現症日情報
                                    </h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                現症日（西暦） <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="currentSymptomsDateWestern" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="convertCurrentSymptomsDateToJapanese(this.value)">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                現症日（和暦）
                                            </label>
                                            <input type="text" id="currentSymptomsDateJapanese" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="例：令和6年7月27日">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                現症日の精度
                                            </label>
                                            <select id="currentSymptomsDatePrecision" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="updateCurrentSymptomsDateDisplay()">
                                                <option value="exact">正確な日付</option>
                                                <option value="approximate">頃（おおよその時期）</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                表示用現症日
                                            </label>
                                            <input type="text" id="displayCurrentSymptomsDate" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm bg-gray-50" readonly placeholder="上記の入力に基づいて自動表示されます">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">現症（現在の症状・状態）</label>
                                        <textarea id="currentSymptoms" rows="4" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="現在の症状、治療状況、日常生活への影響などを記入してください"></textarea>
                                    </div>
                                    
                                    <!-- 現症日診断書のアップロード -->
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            現症日診断書
                                        </label>
                                        <div class="flex items-center space-x-4">
                                            <label class="px-4 py-2 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 cursor-pointer transition-all duration-200 text-sm font-medium">
                                                <input type="file" id="currentSymptomsCertificate" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload(this, 'currentSymptomsCertificatePreview')">
                                                ファイルを選択
                                            </label>
                                            <span class="text-sm text-notion-gray-500">PDF、JPG、PNG形式（最大10MB）</span>
                                        </div>
                                        <div id="currentSymptomsCertificatePreview" class="mt-3 hidden">
                                            <div class="flex items-center p-3 bg-notion-gray-50 rounded-lg border border-notion-gray-200">
                                                <svg class="w-8 h-8 text-purple-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-5L9 2H4z" clip-rule="evenodd"/>
                                                </svg>
                                                <div class="flex-1">
                                                    <p class="text-sm font-medium text-gray-900" id="currentSymptomsFileName"></p>
                                                    <p class="text-sm text-gray-500" id="currentSymptomsFileSize"></p>
                                                </div>
                                                <button type="button" onclick="removeFile('currentSymptomsCertificate', 'currentSymptomsCertificatePreview')" class="text-red-500 hover:text-red-700">
                                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 初診日詳細 -->
                                <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                                    <h3 class="text-lg font-medium text-notion-gray-800 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-blue-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                                        </svg>
                                        初診日情報
                                    </h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                初診日（西暦） <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="initialVisitDateWestern" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="convertToJapaneseDate(this.value)">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                初診日（和暦）
                                            </label>
                                            <input type="text" id="initialVisitDateJapanese" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="例：令和5年4月15日">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                初診日の精度
                                            </label>
                                            <select id="initialVisitDatePrecision" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="updateDateDisplay()">
                                                <option value="exact">正確な日付</option>
                                                <option value="approximate">頃（おおよその時期）</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                表示用初診日
                                            </label>
                                            <input type="text" id="displayInitialVisitDate" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm bg-gray-50" readonly placeholder="上記の入力に基づいて自動表示されます">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                初診時医療機関名 <span class="text-red-500">*</span>
                                            </label>
                                            <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="○○病院、○○クリニック">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">初診の状況</label>
                                            <textarea rows="4" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="初診時の症状、受診経緯、医師の診断内容等を具体的に記載してください（例：頭痛と吐き気で救急外来を受診、MRI検査の結果...）"></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- 受診状況等証明書のアップロード -->
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            受診状況等証明書
                                        </label>
                                        <div class="flex items-center space-x-4">
                                            <label class="px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 cursor-pointer transition-all duration-200 text-sm font-medium">
                                                <input type="file" id="initialVisitCertificate" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload(this, 'initialVisitCertificatePreview')">
                                                ファイルを選択
                                            </label>
                                            <span class="text-sm text-notion-gray-500">PDF、JPG、PNG形式（最大10MB）</span>
                                        </div>
                                        <div id="initialVisitCertificatePreview" class="mt-3 hidden">
                                            <div class="flex items-center p-3 bg-notion-gray-50 rounded-lg border border-notion-gray-200">
                                                <svg class="w-8 h-8 text-blue-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-5L9 2H4z" clip-rule="evenodd"/>
                                                </svg>
                                                <div class="flex-1">
                                                    <p class="text-sm font-medium text-gray-900" id="initialVisitFileName"></p>
                                                    <p class="text-sm text-gray-500" id="initialVisitFileSize"></p>
                                                </div>
                                                <button type="button" onclick="removeFile('initialVisitCertificate', 'initialVisitCertificatePreview')" class="text-red-500 hover:text-red-700">
                                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 診断書の保存 -->
                                <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                                    <h3 class="text-lg font-medium text-notion-gray-800 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-green-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"/>
                                        </svg>
                                        診断書の保存
                                    </h3>
                                    
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                証明書画像をアップロード <span class="text-red-500">*</span>
                                            </label>
                                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-linear-blue-400 transition-colors duration-200">
                                                <input type="file" id="medicalCertificate" accept="image/*,.pdf" class="hidden" onchange="handleFileUpload(this, 'certificatePreview')">
                                                <label for="medicalCertificate" class="cursor-pointer">
                                                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                    <div class="mt-4">
                                                        <p class="text-sm text-gray-600">
                                                            <span class="font-medium text-linear-blue-600 hover:text-linear-blue-500">ファイルを選択</span>
                                                            またはドラッグ&ドロップ
                                                        </p>
                                                        <p class="text-xs text-gray-500">PNG, JPG, PDF形式（最大10MB）</p>
                                                    </div>
                                                </label>
                                            </div>
                                            <div id="certificatePreview" class="mt-4 hidden">
                                                <div class="flex items-center p-3 bg-white rounded-lg border border-gray-200">
                                                    <svg class="w-8 h-8 text-green-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd"/>
                                                    </svg>
                                                    <div class="flex-1">
                                                        <p class="text-sm font-medium text-gray-900" id="fileName"></p>
                                                        <p class="text-sm text-gray-500" id="fileSize"></p>
                                                    </div>
                                                    <button type="button" onclick="removeFile('medicalCertificate', 'certificatePreview')" class="text-red-500 hover:text-red-700">
                                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 障害認定日詳細 -->
                                <div class="bg-orange-50 p-6 rounded-lg border border-orange-200">
                                    <h3 class="text-lg font-medium text-notion-gray-800 mb-4 flex items-center">
                                        <svg class="w-5 h-5 text-orange-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                        </svg>
                                        障害認定日情報
                                    </h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                障害認定日（西暦） <span class="text-red-500">*</span>
                                            </label>
                                            <input type="date" id="disabilityRecognitionDateWestern" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="convertDisabilityDateToJapanese(this.value)">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                障害認定日（和暦）
                                            </label>
                                            <input type="text" id="disabilityRecognitionDateJapanese" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="例：令和5年10月15日">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                障害認定日の精度
                                            </label>
                                            <select id="disabilityRecognitionDatePrecision" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" onchange="updateDisabilityDateDisplay()">
                                                <option value="exact">正確な日付</option>
                                                <option value="approximate">頃（おおよその時期）</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                                表示用障害認定日
                                            </label>
                                            <input type="text" id="displayDisabilityRecognitionDate" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm bg-gray-50" readonly placeholder="上記の入力に基づいて自動表示されます">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">障害認定日の根拠・説明</label>
                                        <textarea rows="3" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="障害認定日の設定根拠や医師の判断内容等を記載してください"></textarea>
                                    </div>
                                    
                                    <!-- 認定日診断書のアップロード -->
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            認定日診断書
                                        </label>
                                        <div class="flex items-center space-x-4">
                                            <label class="px-4 py-2 bg-orange-50 text-orange-600 rounded-lg hover:bg-orange-100 cursor-pointer transition-all duration-200 text-sm font-medium">
                                                <input type="file" id="disabilityDateCertificate" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload(this, 'disabilityDateCertificatePreview')">
                                                ファイルを選択
                                            </label>
                                            <span class="text-sm text-notion-gray-500">PDF、JPG、PNG形式（最大10MB）</span>
                                        </div>
                                        <div id="disabilityDateCertificatePreview" class="mt-3 hidden">
                                            <div class="flex items-center p-3 bg-notion-gray-50 rounded-lg border border-notion-gray-200">
                                                <svg class="w-8 h-8 text-orange-500 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-5L9 2H4z" clip-rule="evenodd"/>
                                                </svg>
                                                <div class="flex-1">
                                                    <p class="text-sm font-medium text-gray-900" id="disabilityDateFileName"></p>
                                                    <p class="text-sm text-gray-500" id="disabilityDateFileSize"></p>
                                                </div>
                                                <button type="button" onclick="removeFile('disabilityDateCertificate', 'disabilityDateCertificatePreview')" class="text-red-500 hover:text-red-700">
                                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 障害等級 -->
                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-2">障害等級</label>
                                    <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                        <option value="">選択してください</option>
                                        <option value="1級">1級</option>
                                        <option value="2級">2級</option>
                                        <option value="3級">3級</option>
                                        <option value="障害手当金">障害手当金</option>
                                        <option value="未定">未定</option>
                                    </select>
                                </div>

                                <!-- 症状詳細 -->
                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-2">症状詳細</label>
                                    <textarea rows="4" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="具体的な症状を記載してください"></textarea>
                                </div>

                                <!-- 治療情報 -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">現在の治療内容</label>
                                        <textarea rows="3" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="通院频度、治療内容など"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">投薬歴</label>
                                        <textarea rows="3" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="服用中の薬剤名、用量など"></textarea>
                                    </div>
                                </div>

                                <!-- 日常生活・就労への影響 -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">日常生活への影響</label>
                                        <textarea rows="3" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="食事、入浴、外出等への影響"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">就労への影響</label>
                                        <textarea rows="3" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="就労状況、業務への影響など"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 申請管理情報 -->
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl border border-notion-gray-200/60 shadow-notion overflow-hidden">
                            <div class="bg-purple-50 px-6 py-4 border-b border-notion-gray-200/60">
                                <h2 class="text-xl font-semibold text-notion-gray-800 flex items-center">
                                    <div class="w-6 h-6 bg-purple-500 rounded-lg flex items-center justify-center mr-3">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd"/>
                                            <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"/>
                                        </svg>
                                    </div>
                                    申請管理情報
                                </h2>
                            </div>
                            
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">
                                            年金種類 <span class="text-red-500">*</span>
                                        </label>
                                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                                            <option value="">選択してください</option>
                                            <option value="basic">基礎年金</option>
                                            <option value="employees">厚生年金</option>
                                            <option value="mutual">共済年金</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">担当者</label>
                                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="佐藤花子">
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-notion-gray-700 mb-2">売上見込み</label>
                                    <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="300000" min="0">
                                </div>
                            </div>
                        </div>

                        <!-- アクションボタン -->
                        <div class="flex justify-center space-x-4 pt-8">
                            <button type="button" class="px-8 py-3 text-notion-gray-600 border border-notion-gray-300 rounded-lg hover:bg-notion-gray-50 transition-all duration-200 flex items-center space-x-2" onclick="window.history.back()">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                                <span>キャンセル</span>
                            </button>
                            <button type="submit" class="px-8 py-3 bg-linear-blue-600 hover:bg-linear-blue-700 text-white rounded-lg transition-all duration-200 shadow-linear flex items-center space-x-2">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                </svg>
                                <span id="submitButtonText">申請を保存</span>
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <script>
        // 基本テスト
        console.log('JavaScript loaded successfully');
        
        // ページ初期化：編集モードか新規作成モードかを判定
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded fired');
            
            const urlParams = new URLSearchParams(window.location.search);
            const editId = urlParams.get('edit');
            const viewId = urlParams.get('view');
            const isEditMode = editId !== null;
            const isViewMode = viewId !== null;
            const currentId = editId || viewId;
            
            console.log('URL Parameters:', window.location.search);
            console.log('Edit ID:', editId);
            console.log('View ID:', viewId);
            console.log('Current ID:', currentId);
            console.log('Is Edit Mode:', isEditMode);
            console.log('Is View Mode:', isViewMode);
            
            if (isEditMode) {
                // 編集モードの場合
                console.log('Setting edit mode...');
                
                const titleElement = document.getElementById('pageTitle');
                const subtitleElement = document.getElementById('pageSubtitle');
                const buttonElement = document.getElementById('submitButtonText');
                const editModeIndicator = document.getElementById('editModeIndicator');
                
                if (titleElement) {
                    titleElement.textContent = '申請情報編集';
                }
                
                if (subtitleElement) {
                    subtitleElement.textContent = `申請ID: APP-2024-${String(editId).padStart(3, '0')} の情報を編集しています`;
                }
                
                if (buttonElement) {
                    buttonElement.textContent = '変更を保存';
                }
                
                if (editModeIndicator) {
                    editModeIndicator.classList.remove('hidden');
                }
                
                // 少し遅延してからデータを読み込み
                setTimeout(() => {
                    loadExistingData(editId);
                }, 100);
            } else if (isViewMode) {
                // 表示モードの場合
                console.log('Setting view mode...');
                alert('View mode detected! ViewID: ' + viewId);
                
                const titleElement = document.getElementById('pageTitle');
                const subtitleElement = document.getElementById('pageSubtitle');
                const buttonElement = document.getElementById('submitButtonText');
                
                if (titleElement) {
                    titleElement.textContent = '申請情報詳細';
                    alert('Title changed to: ' + titleElement.textContent);
                }
                
                if (subtitleElement) {
                    subtitleElement.textContent = `申請ID: APP-2024-${String(viewId).padStart(3, '0')} の詳細情報`;
                }
                
                if (buttonElement) {
                    buttonElement.textContent = '編集モードに切り替え';
                }
                
                // データを読み込み
                setTimeout(() => {
                    loadExistingData(viewId);
                    // データ読み込み後にフォームを読み取り専用にする
                    setTimeout(() => {
                        makeFormReadOnly();
                    }, 500);
                }, 100);
            } else {
                console.log('New application mode');
            }
        });

        // フォームを読み取り専用にする関数
        function makeFormReadOnly() {
            const form = document.querySelector('form');
            if (form) {
                // すべての入力フィールドを無効化
                const inputs = form.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.disabled = true;
                    input.style.backgroundColor = '#f7f6f3';
                    input.style.cursor = 'not-allowed';
                });
                
                // viewモードでのみ削除ボタンとaddChildボタンを非表示
                const urlParams = new URLSearchParams(window.location.search);
                const isViewMode = urlParams.get('view') !== null;
                
                if (isViewMode) {
                    const removeButtons = form.querySelectorAll('button[onclick*="removeChild"]');
                    removeButtons.forEach(btn => {
                        btn.style.display = 'none';
                    });
                    
                    const addChildButton = form.querySelector('button[onclick*="addChild"]');
                    if (addChildButton) {
                        addChildButton.style.display = 'none';
                    }
                }
                
                // ボタンのクリックイベントを変更
                const submitBtn = document.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.onclick = function(e) {
                        e.preventDefault();
                        const currentId = new URLSearchParams(window.location.search).get('view');
                        window.location.href = `project-unified.html?edit=${currentId}`;
                    };
                }
            }
        }

        // 既存データの読み込み
        async function loadExistingData(editId) {
            try {
                // APIから実際のデータを取得
                if (typeof loadApplication === 'function') {
                    await loadApplication(editId);
                    return;
                }
            } catch (error) {
                console.error('Failed to load data from API, falling back to sample data:', error);
            }
            
            // フォールバック用サンプルデータ
            const sampleData = {
                '1': {
                    name: '田中太郎',
                    furigana: 'タナカタロウ',
                    age: 42,
                    gender: 'male',
                    birthday: '1982-05-15',
                    pensionNumber: '1234-567890',
                    phone: '03-1234-5678',
                    email: 'tanaka@example.com',
                    address: '東京都新宿区西新宿1-1-1',
                    hasSpouse: 'true',
                    spouse: {
                        name: '田中花子',
                        furigana: 'タナカハナコ',
                        mynumber: '123456789012',
                        pensionNumber: '2345-678901',
                        birthday: '1985-03-20',
                        age: 39,
                        gender: 'female',
                        income1: 2800000,
                        income2: 2900000,
                        spouseAddition: 'yes',
                        transferAddition: 'no',
                        address: '東京都新宿区西新宿1-1-1',
                        phone: '03-1234-5679',
                        email: 'hanako@example.com'
                    },
                    disease: 'うつ病',
                    firstVisit: '2023-05-10',
                    disabilityDate: '2023-11-10',
                    hospital: '新宿病院',
                    doctor: '山田医師',
                    grade: '2級',
                    symptoms: '気分の落ち込み、集中力低下、睡眠障害が継続している',
                    treatment: '週1回の通院、抗うつ薬の服用、カウンセリング',
                    medication: 'セルトラリン50mg、ロラゼパム0.5mg',
                    hasChildren: 'true',
                    childrenData: [
                        {
                            name: '田中一郎',
                            furigana: 'タナカイチロウ',
                            birthday: '2010-04-01',
                            age: 14,
                            gender: 'male',
                            mynumber: '345678901234',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '新宿中学校',
                            schoolYear: '2年'
                        },
                        {
                            name: '田中次郎',
                            furigana: 'タナカジロウ',
                            birthday: '2012-07-15',
                            age: 12,
                            gender: 'male',
                            mynumber: '456789012345',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '新宿小学校',
                            schoolYear: '6年'
                        }
                    ]
                },
                '2': {
                    name: '山田花子',
                    furigana: 'ヤマダハナコ',
                    age: 35,
                    gender: 'female',
                    birthday: '1989-08-22',
                    pensionNumber: '3456-789012',
                    phone: '03-2345-6789',
                    email: 'yamada@example.com',
                    address: '東京都渋谷区神南1-2-3',
                    hasSpouse: 'false',
                    disease: '統合失調症',
                    firstVisit: '2022-03-15',
                    disabilityDate: '2022-09-15',
                    hospital: '渋谷メンタルクリニック',
                    doctor: '佐藤医師',
                    grade: '1級',
                    symptoms: '幻聴、妄想、思考の混乱が見られる',
                    treatment: '月2回の通院、抗精神病薬の服用、デイケア参加',
                    medication: 'リスペリドン2mg、ロラゼパム1mg',
                    hasChildren: 'false'
                },
                '3': {
                    name: '佐藤一郎',
                    furigana: 'サトウイチロウ',
                    age: 58,
                    gender: 'male',
                    birthday: '1966-12-03',
                    pensionNumber: '4567-890123',
                    phone: '03-3456-7890',
                    email: 'sato@example.com', 
                    address: '東京都世田谷区三軒茶屋2-3-4',
                    hasSpouse: 'true',
                    spouse: {
                        name: '佐藤美香',
                        furigana: 'サトウミカ',
                        mynumber: '567890123456',
                        pensionNumber: '5678-901234',
                        birthday: '1970-01-10',
                        age: 54,
                        gender: 'female',
                        income1: 3200000,
                        income2: 3300000,
                        spouseAddition: 'yes',
                        transferAddition: 'no',
                        address: '東京都世田谷区三軒茶屋2-3-4',
                        phone: '03-3456-7891',
                        email: 'mika@example.com'
                    },
                    disease: '腰椎椎間板ヘルニア',
                    firstVisit: '2021-08-10',
                    disabilityDate: '2022-02-10',
                    hospital: '世田谷整形外科',
                    doctor: '鈴木医師',
                    grade: '3級',
                    symptoms: '腰部の激痛、下肢のしびれ、歩行困難',
                    treatment: '理学療法、痛み止めの服用、週1回のリハビリ',
                    medication: 'ロキソニン60mg、リリカ75mg',
                    hasChildren: 'true',
                    childrenData: [
                        {
                            name: '佐藤健太',
                            furigana: 'サトウケンタ',
                            birthday: '2005-09-12',
                            age: 19,
                            gender: 'male',
                            mynumber: '678901234567',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '東京大学',
                            schoolYear: '1年'
                        },
                        {
                            name: '佐藤美穂',
                            furigana: 'サトウミホ',
                            birthday: '2007-11-25',
                            age: 17,
                            gender: 'female',
                            mynumber: '789012345678',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '都立高校',
                            schoolYear: '2年'
                        },
                        {
                            name: '佐藤大輔',
                            furigana: 'サトウダイスケ',
                            birthday: '2009-03-08',
                            age: 15,
                            gender: 'male',
                            mynumber: '890123456789',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '世田谷中学校',
                            schoolYear: '3年'
                        }
                    ]
                },
                '4': {
                    name: '鈴木次郎',
                    furigana: 'スズキジロウ',
                    age: 29,
                    gender: 'male',
                    birthday: '1995-06-18',
                    pensionNumber: '6789-012345',
                    phone: '03-4567-8901',
                    email: 'suzuki@example.com',
                    address: '東京都練馬区石神井町4-5-6',
                    hasSpouse: 'true',
                    spouse: {
                        name: '鈴木恵子',
                        furigana: 'スズキケイコ',
                        mynumber: '901234567890',
                        pensionNumber: '7890-123456',
                        birthday: '1997-02-14',
                        age: 27,
                        gender: 'female',
                        income1: 2500000,
                        income2: 2600000,
                        spouseAddition: 'yes',
                        transferAddition: 'no',
                        address: '東京都練馬区石神井町4-5-6',
                        phone: '03-4567-8902',
                        email: 'keiko@example.com'
                    },
                    disease: '双極性障害',
                    firstVisit: '2023-12-01',
                    disabilityDate: '2024-06-01',
                    hospital: '練馬心療内科',
                    doctor: '高橋医師',
                    grade: '2級',
                    symptoms: '躁状態とうつ状態の繰り返し、気分の激しい変動',
                    treatment: '月1回の通院、気分安定薬の服用、心理療法',
                    medication: 'リチウム300mg、ラモトリギン100mg',
                    hasChildren: 'false'
                },
                '5': {
                    name: '高橋三郎',
                    furigana: 'タカハシサブロウ',
                    age: 52,
                    gender: 'male',
                    birthday: '1972-04-05',
                    pensionNumber: '8901-234567',
                    phone: '03-5678-9012',
                    email: 'takahashi@example.com',
                    address: '東京都中野区中野5-6-7',
                    hasSpouse: 'false',
                    disease: '関節リウマチ',
                    firstVisit: '2022-11-20',
                    disabilityDate: '2023-05-20',
                    hospital: '中野リウマチクリニック',
                    doctor: '伊藤医師',
                    grade: '3級',
                    symptoms: '全身の関節痛、朝のこわばり、関節の腫れ',
                    treatment: '月2回の通院、抗リウマチ薬の服用、理学療法',
                    medication: 'メトトレキサート10mg、プレドニゾロン5mg',
                    hasChildren: 'true',
                    childrenData: [
                        {
                            name: '高橋優子',
                            furigana: 'タカハシユウコ',
                            birthday: '2000-12-10',
                            age: 24,
                            gender: 'female',
                            mynumber: '012345678901',
                            pensionNumber: '',
                            isStudent: 'no',
                            occupation: '会社員'
                        },
                        {
                            name: '高橋健一',
                            furigana: 'タカハシケンイチ',
                            birthday: '2003-08-15',
                            age: 21,
                            gender: 'male',
                            mynumber: '123456789012',
                            pensionNumber: '',
                            isStudent: 'yes',
                            schoolName: '専門学校',
                            schoolYear: '2年'
                        }
                    ]
                },
                '001': {
                    name: '田中太郎',
                    furigana: 'タナカタロウ',
                    age: 42,
                    gender: 'male',
                    birthday: '1982-05-15',
                    pensionNumber: '1234-567890',
                    phone: '03-1234-5678',
                    email: 'tanaka@example.com',
                    address: '東京都新宿区西新宿1-1-1',
                    hasSpouse: 'true',
                    spouse: {
                        name: '田中花子',
                        furigana: 'タナカハナコ',
                        mynumber: '123456789012',
                        pensionNumber: '2345-678901',
                        birthday: '1985-03-20',
                        age: 39,
                        gender: 'female',
                        income1: 2800000,
                        income2: 2900000,
                        spouseAddition: 'yes',
                        transferAddition: 'no',
                        address: '東京都新宿区西新宿1-1-1',
                        phone: '03-1234-5679',
                        email: 'hanako@example.com'
                    },
                    disease: 'うつ病',
                    firstVisit: '2023-05-10',
                    disabilityDate: '2023-11-10',
                    hospital: '新宿病院',
                    doctor: '山田医師',
                    grade: '2級',
                    symptoms: '気分の落ち込み、集中力低下、睡眠障害が継続している',
                    treatment: '週1回の通院、抗うつ薬の服用、カウンセリング',
                    medication: 'セルトラリン50mg、ロラゼパム0.5mg',
                    dailyLife: '家事や外出に支障があり、日常生活に介助が必要',
                    work: '現在休職中、復職の見込みは不明',
                    pensionType: 'employees',
                    manager: '佐藤花子',
                    revenue: 300000
                },
                '002': {
                    name: '山田花子',
                    furigana: 'ヤマダハナコ',
                    age: 35,
                    gender: 'female',
                    birthday: '1989-03-15',
                    pensionNumber: '3456-789012',
                    phone: '03-2345-6789',
                    email: 'yamada@example.com',
                    address: '東京都渋谷区渋谷2-2-2',
                    hasSpouse: 'false',
                    disease: '統合失調症',
                    firstVisit: '2022-03-15',
                    disabilityDate: '2022-09-15',
                    hospital: '渋谷メンタルクリニック',
                    doctor: '田中医師',
                    grade: '2級',
                    symptoms: '幻聴、妄想、思考のまとまりの欠如',
                    treatment: '月2回の通院、抗精神病薬の服用',
                    medication: 'リスペリドン4mg、ビペリデン2mg',
                    dailyLife: '一人での外出が困難、金銭管理に支援が必要',
                    work: '就労移行支援事業所に通所中',
                    pensionType: 'basic',
                    manager: '田中一郎',
                    revenue: 250000
                }
            };
            
            const data = sampleData[editId] || sampleData['1'];
            
            console.log('Loading data for editId:', editId);
            console.log('Sample data keys:', Object.keys(sampleData));
            console.log('Found data:', data);
            console.log('Data:', data);
            
            // フォームにデータを入力 - より確実な方法
            try {
                // 申請者基本情報 - より確実なセレクタを使用
                const inputs = document.querySelectorAll('input, select');
                console.log('Found inputs:', inputs.length);
                
                // 基本情報フィールドを位置で特定（より確実）
                if (inputs.length >= 9) {
                    if (inputs[0] && inputs[0].type === 'text') inputs[0].value = data.name || '';
                    if (inputs[1] && inputs[1].type === 'text') inputs[1].value = data.furigana || '';
                    if (inputs[2] && inputs[2].type === 'number') inputs[2].value = data.age || '';
                    if (inputs[3] && inputs[3].tagName === 'SELECT') inputs[3].value = data.gender || '';
                    if (inputs[4] && inputs[4].type === 'date') inputs[4].value = data.birthday || '';
                    if (inputs[5] && inputs[5].type === 'text') inputs[5].value = data.pensionNumber || '';
                    if (inputs[6] && inputs[6].type === 'tel') inputs[6].value = data.phone || '';
                    if (inputs[7] && inputs[7].type === 'email') inputs[7].value = data.email || '';
                    if (inputs[8] && inputs[8].type === 'text') inputs[8].value = data.address || '';
                }
                
                console.log('Basic info loaded successfully:', {
                    name: data.name,
                    furigana: data.furigana,
                    age: data.age
                });
            } catch (error) {
                console.error('Error loading basic info:', error);
            }
            
            // 配偶者情報
            try {
                if (data.hasSpouse === 'true') {
                    const spouseYesRadio = document.querySelector('input[name="hasSpouse"][value="true"]');
                    if (spouseYesRadio) {
                        spouseYesRadio.checked = true;
                        // 手動でchangeイベントを発火させて配偶者情報を表示
                        spouseYesRadio.dispatchEvent(new Event('change'));
                    }
                    
                    // 配偶者情報表示を確実にする
                    setTimeout(() => {
                        const spouseInfo = document.getElementById('spouseInfo');
                        if (spouseInfo) {
                            spouseInfo.classList.remove('hidden');
                        }
                        
                        if (data.spouse) {
                            // 配偶者の各フィールドに値を設定
                            const spouseInputs = document.getElementById('spouseInfo').querySelectorAll('input, select');
                            console.log('Found spouse inputs:', spouseInputs.length);
                            
                            if (spouseInputs.length >= 14) {
                                spouseInputs[0].value = data.spouse.name || ''; // 氏名
                                spouseInputs[1].value = data.spouse.furigana || ''; // フリガナ
                                spouseInputs[2].value = data.spouse.mynumber || ''; // マイナンバー
                                spouseInputs[3].value = data.spouse.pensionNumber || ''; // 基礎年金番号
                                spouseInputs[4].value = data.spouse.birthday || ''; // 生年月日
                                spouseInputs[5].value = data.spouse.age || ''; // 年齢
                                spouseInputs[6].value = data.spouse.gender || ''; // 性別
                                spouseInputs[7].value = data.spouse.income1 || ''; // 年収（前年度）
                                spouseInputs[8].value = data.spouse.income2 || ''; // 年収（前々年度）
                                spouseInputs[9].value = data.spouse.spouseAddition || ''; // 配偶者加算対象
                                spouseInputs[10].value = data.spouse.address || ''; // 住所
                                spouseInputs[11].value = data.spouse.phone || ''; // 電話番号
                                spouseInputs[12].value = data.spouse.email || ''; // メールアドレス
                                console.log('Spouse info loaded successfully');
                            }
                        }
                    }, 200);
                } else {
                    const spouseNoRadio = document.querySelector('input[name="hasSpouse"][value="false"]');
                    if (spouseNoRadio) {
                        spouseNoRadio.checked = true;
                    }
                }
            } catch (error) {
                console.error('Error loading spouse info:', error);
            }
            
            // 傷病情報
            try {
                const diseaseInput = document.querySelector('input[placeholder="うつ病、統合失調症など"]');
                const currentSymptomsTextarea = document.getElementById('currentSymptoms');
                const firstVisitInput = document.querySelectorAll('input[type="date"]')[1];
                const disabilityDateInput = document.querySelectorAll('input[type="date"]')[2];
                const hospitalInput = document.querySelector('input[placeholder="○○病院、○○クリニック"]');
                const doctorInput = document.querySelector('input[placeholder="田中医師"]');
                const gradeSelect = document.querySelectorAll('select')[2];
                const symptomsTextarea = document.querySelector('textarea[placeholder="具体的な症状を記載してください"]');
                const treatmentTextarea = document.querySelector('textarea[placeholder="通院频度、治療内容など"]');
                const medicationTextarea = document.querySelector('textarea[placeholder="服用中の薬剤名、用量など"]');
                const dailyLifeTextarea = document.querySelector('textarea[placeholder="食事、入浴、外出等への影響"]');
                const workTextarea = document.querySelector('textarea[placeholder="就労状況、業務への影響など"]');
                
                if (diseaseInput) diseaseInput.value = data.disease || '';
                if (currentSymptomsTextarea) currentSymptomsTextarea.value = data.currentSymptoms || '';
                if (firstVisitInput) firstVisitInput.value = data.firstVisit || '';
                if (disabilityDateInput) disabilityDateInput.value = data.disabilityDate || '';
                if (hospitalInput) hospitalInput.value = data.hospital || '';
                if (doctorInput) doctorInput.value = data.doctor || '';
                if (gradeSelect) gradeSelect.value = data.grade || '';
                if (symptomsTextarea) symptomsTextarea.value = data.symptoms || '';
                if (treatmentTextarea) treatmentTextarea.value = data.treatment || '';
                if (medicationTextarea) medicationTextarea.value = data.medication || '';
                if (dailyLifeTextarea) dailyLifeTextarea.value = data.dailyLife || '';
                if (workTextarea) workTextarea.value = data.work || '';
                
                console.log('Disease info loaded successfully');
            } catch (error) {
                console.error('Error loading disease info:', error);
            }
            
            // 申請管理情報
            try {
                const pensionTypeSelect = document.querySelectorAll('select')[3];
                const managerInput = document.querySelector('input[placeholder="佐藤花子"]');
                const revenueInput = document.querySelector('input[placeholder="300000"]');
                
                if (pensionTypeSelect) pensionTypeSelect.value = data.pensionType || '';
                if (managerInput) managerInput.value = data.manager || '';
                if (revenueInput) revenueInput.value = data.revenue || '';
                
                console.log('Management info loaded successfully');
            } catch (error) {
                console.error('Error loading management info:', error);
            }
        }

        // 配偶者有無によるフィールド表示切替
        document.querySelectorAll('input[name="hasSpouse"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const spouseInfo = document.getElementById('spouseInfo');
                if (this.value === 'true') {
                    spouseInfo.classList.remove('hidden');
                } else {
                    spouseInfo.classList.add('hidden');
                }
            });
        });

        // 子ども情報追加機能
        let childCount = 0;
        function addChild() {
            childCount++;
            const childrenList = document.getElementById('childrenList');
            
            if (childCount === 1) {
                childrenList.innerHTML = '';
            }
            
            const childItem = document.createElement('div');
            childItem.className = 'border border-notion-gray-200 rounded-lg p-6 space-y-6 bg-notion-gray-50';
            childItem.innerHTML = `
                <div class="flex items-center justify-between">
                    <h4 class="font-semibold text-notion-gray-700 text-lg flex items-center">
                        <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2">
                            <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 2L3 7v11a2 2 0 002 2h4v-6h2v6h4a2 2 0 002-2V7l-7-5z"/>
                            </svg>
                        </div>
                        子ども ${childCount}
                    </h4>
                    <button type="button" class="text-red-500 hover:text-red-700 p-1.5 hover:bg-red-100 rounded-lg transition-all duration-200" onclick="removeChild(this)">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                </div>
                
                <!-- 基本情報 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">氏名 <span class="text-red-500">*</span></label>
                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="田中太郎">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">フリガナ <span class="text-red-500">*</span></label>
                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="タナカタロウ">
                    </div>
                </div>
                
                <!-- 個人識別情報 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">マイナンバー <span class="text-red-500">*</span></label>
                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="123456789012" pattern="[0-9]{12}" maxlength="12">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">基礎年金番号</label>
                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="1234-567890" title="20歳以降の場合に記入">
                    </div>
                </div>
                
                <!-- 基本属性 -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">続柄 <span class="text-red-500">*</span></label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択</option>
                            <option value="長男">長男</option>
                            <option value="長女">長女</option>
                            <option value="次男">次男</option>
                            <option value="次女">次女</option>
                            <option value="三男">三男</option>
                            <option value="三女">三女</option>
                            <option value="四男">四男</option>
                            <option value="四女">四女</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">性別</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択</option>
                            <option value="male">男性</option>
                            <option value="female">女性</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">生年月日 <span class="text-red-500">*</span></label>
                        <input type="date" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">年齢</label>
                        <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="12" min="0" max="30">
                    </div>
                </div>
                
                <!-- 障害・疾病情報 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">障害の有無</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択してください</option>
                            <option value="none">なし</option>
                            <option value="physical">身体障害</option>
                            <option value="mental">知的障害</option>
                            <option value="psychiatric">精神障害</option>
                            <option value="developmental">発達障害</option>
                            <option value="other">その他</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">障害等級</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択してください</option>
                            <option value="1">1級</option>
                            <option value="2">2級</option>
                            <option value="3">3級</option>
                            <option value="4">4級</option>
                            <option value="5">5級</option>
                            <option value="6">6級</option>
                            <option value="none">該当なし</option>
                        </select>
                    </div>
                </div>
                
                <!-- 学業・就労情報 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">学業・就労状況</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択してください</option>
                            <option value="student">学生</option>
                            <option value="working">就労中</option>
                            <option value="unemployed">無職</option>
                            <option value="disabled">就労困難</option>
                            <option value="other">その他</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">年収</label>
                        <input type="number" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="0" min="0">
                    </div>
                </div>
                
                <!-- 加算対象情報 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">子の加算対象</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択してください</option>
                            <option value="yes">対象（18歳到達年度末まで、又は20歳未満で障害等級1・2級）</option>
                            <option value="no">対象外</option>
                            <option value="unknown">判定中</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">生計同一</label>
                        <select class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200">
                            <option value="">選択してください</option>
                            <option value="yes">同一生計</option>
                            <option value="no">別生計</option>
                        </select>
                    </div>
                </div>
                
                <!-- 住所情報 -->
                <div class="grid grid-cols-1 md:grid-cols-1 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">住所</label>
                        <input type="text" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200" placeholder="申請者と同じ場合は「同上」">
                    </div>
                </div>
                
                <!-- 備考欄 -->
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-notion-gray-700 mb-2">備考</label>
                        <textarea rows="2" class="w-full px-4 py-3 border border-notion-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-linear-blue-500 focus:border-transparent outline-none transition-all duration-200 resize-none" placeholder="特記事項があれば記載してください"></textarea>
                    </div>
                </div>
            `;
            
            childrenList.appendChild(childItem);
        }

        // 申請データを保存する関数
        function saveApplication() {
            // フォームデータを収集
            const projectData = {
                id: Date.now(),
                name: document.querySelector('input[placeholder="田中太郎"]')?.value || '',
                furigana: document.querySelector('input[placeholder="タナカタロウ"]')?.value || '',
                age: parseInt(document.querySelector('input[placeholder="45"]')?.value) || 0,
                gender: document.querySelector('select')?.value || '',
                birthday: document.querySelector('input[type="date"]')?.value || '',
                pensionNumber: document.querySelector('input[placeholder="1234-567890"]')?.value || '',
                phone: document.querySelector('input[placeholder="090-1234-5678"]')?.value || '',
                email: document.querySelector('input[placeholder="example@email.com"]')?.value || '',
                address: document.querySelector('textarea[placeholder="東京都新宿区..."]')?.value || '',
                hasSpouse: document.querySelector('input[name="spouse"]:checked')?.value || 'no',
                disease: document.querySelector('input[placeholder="うつ病、統合失調症など"]')?.value || '',
                currentSymptoms: document.getElementById('currentSymptoms')?.value || '',
                firstVisit: document.getElementById('initialVisitDateWestern')?.value || '',
                disabilityDate: document.querySelectorAll('input[type="date"]')[2]?.value || '',
                hospital: document.querySelector('input[placeholder="○○病院、○○クリニック"]')?.value || '',
                doctor: document.querySelector('input[placeholder="田中医師"]')?.value || '',
                grade: document.querySelectorAll('select')[2]?.value || '',
                symptoms: document.querySelector('textarea[placeholder="具体的な症状を記載してください"]')?.value || '',
                treatment: document.querySelector('textarea[placeholder="通院频度、治療内容など"]')?.value || '',
                medication: document.querySelector('textarea[placeholder="服用中の薬剤名、用量など"]')?.value || '',
                dailyLife: document.querySelector('textarea[placeholder="食事、入浴、外出等への影響"]')?.value || '',
                work: document.querySelector('textarea[placeholder="就労状況、業務への影響など"]')?.value || '',
                hasChildren: document.querySelector('input[name="children"]:checked')?.value || 'false',
                status: 'draft',
                createdAt: new Date().toISOString()
            };
            
            // ローカルストレージから既存のプロジェクトを取得
            let projects = JSON.parse(localStorage.getItem('pensionProjects') || '[]');
            
            // 新しいプロジェクトを追加
            projects.push(projectData);
            
            // ローカルストレージに保存
            localStorage.setItem('pensionProjects', JSON.stringify(projects));
            
            console.log('Saving application...', projectData);
            
            // 成功メッセージを表示
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg text-white bg-green-500 transition-all duration-300 z-50';
            notification.textContent = '保存しました';
            document.body.appendChild(notification);
            
            // 通知を3秒後に削除
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
            
            // 2秒後にプロジェクト一覧に遷移
            setTimeout(() => {
                window.location.href = 'projects.html';
            }, 2000);
        }

        // 和暦変換機能
        function convertToJapaneseDate(westernDate) {
            if (!westernDate) return;
            
            const date = new Date(westernDate);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            let era, eraYear;
            
            if (year >= 2019 && (year > 2019 || month >= 5)) {
                // 令和元年は2019年5月1日から
                era = '令和';
                eraYear = year - 2018;
            } else if (year >= 1989) {
                // 平成元年は1989年1月8日から
                era = '平成';
                eraYear = year - 1988;
            } else if (year >= 1926) {
                // 昭和元年は1926年12月25日から
                era = '昭和';
                eraYear = year - 1925;
            } else if (year >= 1912) {
                // 大正元年は1912年7月30日から
                era = '大正';
                eraYear = year - 1911;
            } else {
                // 明治
                era = '明治';
                eraYear = year - 1867;
            }
            
            // 元年の場合の表記調整
            const yearText = eraYear === 1 ? '元' : eraYear;
            const japaneseDate = `${era}${yearText}年${month}月${day}日`;
            
            document.getElementById('initialVisitDateJapanese').value = japaneseDate;
            updateDateDisplay();
        }
        
        // 表示用日付の更新
        function updateDateDisplay() {
            const westernDate = document.getElementById('initialVisitDateWestern').value;
            const japaneseDate = document.getElementById('initialVisitDateJapanese').value;
            const precision = document.getElementById('initialVisitDatePrecision').value;
            const displayField = document.getElementById('displayInitialVisitDate');
            
            if (!westernDate && !japaneseDate) {
                displayField.value = '';
                return;
            }
            
            let displayText = '';
            if (japaneseDate) {
                displayText = japaneseDate;
            } else if (westernDate) {
                const date = new Date(westernDate);
                displayText = `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
            }
            
            if (precision === 'approximate' && displayText) {
                displayText += '頃';
            }
            
            displayField.value = displayText;
        }
        
        // 障害認定日の和暦変換機能
        function convertDisabilityDateToJapanese(westernDate) {
            if (!westernDate) return;
            
            const date = new Date(westernDate);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            let era, eraYear;
            
            if (year >= 2019 && (year > 2019 || month >= 5)) {
                // 令和元年は2019年5月1日から
                era = '令和';
                eraYear = year - 2018;
            } else if (year >= 1989) {
                // 平成元年は1989年1月8日から
                era = '平成';
                eraYear = year - 1988;
            } else if (year >= 1926) {
                // 昭和元年は1926年12月25日から
                era = '昭和';
                eraYear = year - 1925;
            } else if (year >= 1912) {
                // 大正元年は1912年7月30日から
                era = '大正';
                eraYear = year - 1911;
            } else {
                // 明治
                era = '明治';
                eraYear = year - 1867;
            }
            
            // 元年の場合の表記調整
            const yearText = eraYear === 1 ? '元' : eraYear;
            const japaneseDate = `${era}${yearText}年${month}月${day}日`;
            
            document.getElementById('disabilityRecognitionDateJapanese').value = japaneseDate;
            updateDisabilityDateDisplay();
        }
        
        // 現症日の和暦変換機能
        function convertCurrentSymptomsDateToJapanese(westernDate) {
            if (!westernDate) return;
            
            const date = new Date(westernDate);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            let era, eraYear;
            
            if (year >= 2019 && (year > 2019 || month >= 5)) {
                // 令和元年は2019年5月1日から
                era = '令和';
                eraYear = year - 2018;
            } else if (year >= 1989) {
                // 平成元年は1989年1月8日から
                era = '平成';
                eraYear = year - 1988;
            } else if (year >= 1926) {
                // 昭和元年は1926年12月25日から
                era = '昭和';
                eraYear = year - 1925;
            } else if (year >= 1912) {
                // 大正元年は1912年7月30日から
                era = '大正';
                eraYear = year - 1911;
            } else {
                // 明治
                era = '明治';
                eraYear = year - 1867;
            }
            
            // 元年の場合の表記調整
            const yearText = eraYear === 1 ? '元' : eraYear;
            const japaneseDate = `${era}${yearText}年${month}月${day}日`;
            
            document.getElementById('currentSymptomsDateJapanese').value = japaneseDate;
            updateCurrentSymptomsDateDisplay();
        }
        
        // 障害認定日の表示用日付更新
        function updateDisabilityDateDisplay() {
            const westernDate = document.getElementById('disabilityRecognitionDateWestern').value;
            const japaneseDate = document.getElementById('disabilityRecognitionDateJapanese').value;
            const precision = document.getElementById('disabilityRecognitionDatePrecision').value;
            const displayField = document.getElementById('displayDisabilityRecognitionDate');
            
            if (!westernDate && !japaneseDate) {
                displayField.value = '';
                return;
            }
            
            let displayText = '';
            if (japaneseDate) {
                displayText = japaneseDate;
            } else if (westernDate) {
                const date = new Date(westernDate);
                displayText = `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
            }
            
            if (precision === 'approximate' && displayText) {
                displayText += '頃';
            }
            
            displayField.value = displayText;
        }
        
        // 現症日の表示用日付更新
        function updateCurrentSymptomsDateDisplay() {
            const westernDate = document.getElementById('currentSymptomsDateWestern').value;
            const japaneseDate = document.getElementById('currentSymptomsDateJapanese').value;
            const precision = document.getElementById('currentSymptomsDatePrecision').value;
            const displayField = document.getElementById('displayCurrentSymptomsDate');
            
            if (!westernDate && !japaneseDate) {
                displayField.value = '';
                return;
            }
            
            let displayText = '';
            if (japaneseDate) {
                displayText = japaneseDate;
            } else if (westernDate) {
                const date = new Date(westernDate);
                displayText = `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
            }
            
            if (precision === 'approximate' && displayText) {
                displayText += '頃';
            }
            
            displayField.value = displayText;
        }

        // ファイルアップロード処理
        function handleFileUpload(input, previewId) {
            const file = input.files[0];
            if (!file) return;
            
            // ファイルサイズチェック (10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('ファイルサイズが10MBを超えています。');
                input.value = '';
                return;
            }
            
            // ファイル形式チェック
            if (!file.type.match(/^image\/(png|jpg|jpeg)$/) && file.type !== 'application/pdf') {
                alert('PNG、JPG、PDF形式のファイルのみアップロード可能です。');
                input.value = '';
                return;
            }
            
            // プレビュー表示
            const preview = document.getElementById(previewId);
            const fileName = preview.querySelector('#fileName');
            const fileSize = preview.querySelector('#fileSize');
            
            if (fileName) fileName.textContent = file.name;
            if (fileSize) fileSize.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
            
            preview.classList.remove('hidden');
        }
        
        // ファイル削除
        function removeFile(inputId, previewId) {
            document.getElementById(inputId).value = '';
            document.getElementById(previewId).classList.add('hidden');
        }

        function removeChild(button) {
            // viewモードでは削除を無効化
            const urlParams = new URLSearchParams(window.location.search);
            const isViewMode = urlParams.get('view') !== null;
            
            if (isViewMode) {
                console.log('View mode: child removal disabled');
                return;
            }
            
            try {
                const childElement = button.closest('.border.border-notion-gray-200');
                const childrenList = document.getElementById('childrenList');
                
                if (childElement && childrenList && childrenList.contains(childElement)) {
                    // 親要素に含まれていることを確認してから削除
                    childElement.remove();
                    childCount--;
                    
                    // 残りの子ども要素の番号を振り直し
                    if (childrenList) {
                        const remainingChildren = childrenList.querySelectorAll('.border.border-notion-gray-200');
                        remainingChildren.forEach((child, index) => {
                            const titleElement = child.querySelector('h4');
                            if (titleElement) {
                                titleElement.innerHTML = `
                                    <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2">
                                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M10 2L3 7v11a2 2 0 002 2h4v-6h2v6h4a2 2 0 002-2V7l-7-5z"/>
                                        </svg>
                                    </div>
                                    子ども ${index + 1}
                                `;
                            }
                        });
                        
                        if (childCount === 0) {
                            childrenList.innerHTML = '<div class="text-sm text-notion-gray-500">「子どもを追加」ボタンを押して子ども情報を入力してください</div>';
                        }
                    }
                }
            } catch (error) {
                console.error('Error removing child:', error);
            }
        }
    </script>
</body>
</html>